(window.$WP=window.$WP||[]).push({id:"@ta/hotels.hotel-review-atf-photos-media-window",d:["vendor-react-libs","@ta/hotels.media-album-parts","@ta/hotels.media-album-configuration","vendor-babel","vendor-common","@ta/styleguide.skeleton","ta-common","ta-platform","@ta/public.graphql-util","@ta/media.face-pile"],e:["./packages/hotels/hotel-review-atf-photos-media-window/compositionRoot.jsx"],x:{"./packages/hotels/hotel-review-atf-photos-media-window/compositionRoot.jsx":["default","ssrQueries"]},m:{"./packages/hotels/hotel-review-atf-photos-media-window/compositionRoot.jsx":function(e,t,a){"use strict";a.r(t);var o=a("react"),n=a("@ta/hotels.media-album-parts"),i=a("@ta/hotels.media-album-configuration"),r=a("react-redux"),l=a("lodash/get"),s=a.n(l),c=a("@ta/common.tracking"),u=a.n(c),d=a("@ta/common.is-visible"),m=a("@ta/public.graphql-util"),h=a("@ta/common.classnames"),p=a.n(h),v=a("@ta/common.features"),f=a("@ta/common.radio"),w=a.n(f),b=function e(t,a,o,i){if(Object(v.featureIsEnabled)("hr_photoviewer_web_component"))new w.a("photo-viewer").emit("open");else{var r={detail:t,geo:a,albumViewMode:"grid",updateType:"full",albumId:o,filter:7};i>0&&(o===n.AlbumTypes.PANO_ALBUM?r.panoId="p".concat(i):r.ff=i,r.baseMediaId=i,r.albumViewMode="hero"),require(["trjs!actions/openRespPhotoViewer"],function(e){e.openWithOptions(r)})}},g=a("@ta/styleguide.icon"),_=a("@ta/media.face-pile"),I="hotels-hotel-review-atf-photos-media-window-Albums-Icon__absolute--Sz_iv",k="hotels-hotel-review-atf-photos-media-window-Albums-Icon__overlayIcon--21nnW",A="hotels-hotel-review-atf-photos-media-window-Albums-Icon__iconWrapper--1EVfa",C=function e(){return o.createElement("div",{className:A},o.createElement(g.Icon,{name:"camera-fill",className:p()(k,I)}))},N=function e(t){var a=t.albumId,i=t.avatarData;switch(a){case n.AlbumTypes.TRAVELER_ALBUM:return function e(t){if(!t)return C();var a=t.filter(function(e){return!(!e.userProfile||!e.userProfile.avatar)}).reduce(function(e,t){return e[t.userProfile.avatar.id]=t.userProfile.avatar,e},{}),n=Object.keys(a).reduce(function(e,t){return e.push(a[t]),e},[]).map(function(e){return{withBorder:!0,alt:"",size:"small",photo:{photoSizes:s()(e,"photoSizes",[])}}}).filter(function(e){return!!e}).slice(0,3);return n.length<2?C():o.createElement("span",{className:"hotels-hotel-review-atf-photos-media-window-Albums-Icon__facePile--1qgTW"}," ",o.createElement(_.FacePile,{avatarProps:n,maxFaces:3}))}(i);case n.AlbumTypes.STORYBOARD_ALBUM:return function e(){return o.createElement("div",{className:A},o.createElement(g.Icon,{name:"bubble-rating-bg",className:"hotels-hotel-review-atf-photos-media-window-Albums-Icon__darkIconBg--2kQ2r"}),o.createElement(g.Icon,{name:"play",className:p()(k,I)}))}();case n.AlbumTypes.PANO_ALBUM:return function e(){return o.createElement("div",{className:"hotels-hotel-review-atf-photos-media-window-Albums-Icon__iconWrapperPano--3eV9B"},o.createElement("div",{className:p()(I,"hotels-hotel-review-atf-photos-media-window-Albums-Icon__darkIconBgPano--3WLjh")}),o.createElement(g.Icon,{name:"refresh",className:p()("hotels-hotel-review-atf-photos-media-window-Albums-Icon__overlayIconLarge--1nFR9",I)}),o.createElement("span",{className:p()(I,"hotels-hotel-review-atf-photos-media-window-Albums-Icon__pano360--3bBt_")},"360"))}();case n.AlbumTypes.ROOM_AND_SUITE_ALBUM:return function e(){return o.createElement("div",{className:A},o.createElement(g.Icon,{name:"hotels",className:p()(k,I)}))}();case n.AlbumTypes.DINING_ALBUM:return function e(){return o.createElement("div",{className:A},o.createElement(g.Icon,{name:"restaurants",className:p()(k,I)}))}();default:return C()}};N.defaultProps={avatarData:[]};var P=N,E=function e(t){var a=t.renderIcon&&"function"==typeof t.renderIcon?t.renderIcon():e.defaultProps.renderIcon();return o.createElement("div",{className:p()("hotels-hotel-review-atf-photos-media-window-Albums-Overlay__imageOverlay--1dPs0",t.title?"hotels-hotel-review-atf-photos-media-window-Albums-Overlay__imageOverlayGray--2vR4q":"")},a,t.title,t.count&&o.createElement("span",{className:"hotels-hotel-review-atf-photos-media-window-Albums-Overlay__thinText--Zy5zU"}," (",t.count,") "))},y=function e(){return o.createElement(g.Icon,{name:"play",className:"hotels-hotel-review-atf-photos-media-window-Albums-Overlay__icon--BNwYQ"})};y.displayName="DefaultRenderIcon",E.defaultProps={title:"",count:0,renderIcon:y};var T=E,O={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"TravelerAlbumAvatars"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LocationInformation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"travelerAlbum"},name:{kind:"Name",value:"albums"},arguments:[{kind:"Argument",name:{kind:"Name",value:"albumIds"},value:{kind:"ListValue",values:[{kind:"IntValue",value:"107"}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"10"}},{kind:"ObjectField",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:338}};O.loc.source={body:"0436e30856cb"};var S=O,M="hotels-hotel-review-atf-photos-media-window-Albums-Pane__albumThumbnailWrap--1LzxS",L=function e(t){var a,i=t.albums,r=t.locationId,l=t.geoId,c=t.avatarData,m=t.loading;return i&&0!==i.length&&i.filter&&r&&l?(a=m?function e(t){for(var a=[],o=0;o<t;o++)a.push({albumId:-o,name:"",totalMediaCount:0,mediaList:[]});return a}(3):function e(t){return t.filter(function(e){return 0!==e.mediaList.length}).slice(0,3)}(i)).length<2?null:o.createElement("div",{className:p()("hotels-hotel-review-atf-photos-media-window-Albums-Pane__albumsContainer--3ntPo","hotels-hotel-review-atf-photos-media-window-Albums-Pane__albumColumnWrap--28Xvc"),key:"albums-container"},function e(t,a,i,r,l){return a.map(function(e){var a=e.albumId,c=e.name,m=e.totalMediaCount,h=e.mediaList,v=a===n.AlbumTypes.PANO_ALBUM,f=o.createElement("div",{key:a,className:p()(v?"hotels-hotel-review-atf-photos-media-window-Albums-Pane__albumThumbnailWrapNoBorder--3kreb":M)},o.createElement(n.Thumbnail,{className:"hotels-hotel-review-atf-photos-media-window-Albums-Pane__albumThumb--7OyEj",photoSizes:s()(h,"[0].photoSizes",[]),onClick:function e(){u()({module:"photoviewer",action:"atf_album_click",context:"".concat(a)}),b(i,r,a,a===n.AlbumTypes.STORYBOARD_ALBUM?s()(h,"[0].mediaId",void 0):-1)},loading:t},o.createElement(T,{title:c,count:m,renderIcon:function e(){return o.createElement(P,{albumId:a,avatarData:l})}})));return v?o.createElement(d.HasBeenVisible,{onVisible:function e(){u()({module:"atf_panos_album",action:"in_view",value:0})},key:"track-".concat(a)},function(e){return o.createElement("div",{ref:e,className:M},f)}):f})}(m,a,r,l,c)):null},R=a("@babel/runtime/helpers/esm/classCallCheck"),W=a.n(R),x=a("@babel/runtime/helpers/esm/createClass"),U=a.n(x),B=a("@babel/runtime/helpers/esm/possibleConstructorReturn"),F=a.n(B),j=a("@babel/runtime/helpers/esm/getPrototypeOf"),D=a.n(j),z=a("@babel/runtime/helpers/esm/inherits"),V=a.n(z),G=a("@babel/runtime/helpers/esm/assertThisInitialized"),q=a.n(G),H=a("@babel/runtime/helpers/esm/defineProperty"),Q=a.n(H),Y=a("@ta/styleguide.skeleton"),J=a.n(Y),X=a("@ta/media.common"),$=a("@ta/styleguide.button"),K=a.n($),Z=a("@ta/common.i18n");function ee(){u()({module:"photoviewer",action:"click",context:"add_photo_click"})}var te=function e(t){var a=t.locationId,n=t.geoId,i="/PostPhotos-g".concat(n,"-d").concat(a);return o.createElement("a",{className:"hotels-hotel-review-atf-photos-media-window-Carousel-ATFNoPhotoCTA__addPhotoLinkBlock--1gb1C",href:i,target:"_blank",onClick:ee},o.createElement("div",{className:"hotels-hotel-review-atf-photos-media-window-Carousel-ATFNoPhotoCTA__iconWrap--2iN-q"},o.createElement(g.Icon,{className:"hotels-hotel-review-atf-photos-media-window-Carousel-ATFNoPhotoCTA__cameraIcon--3Erxu",name:"camera"})),o.createElement(K.a,{type:"primary",size:"large"},Object(Z.localize)("mw_add_photo_ffffdfce")))},ae=Object(n.WithContainerDimensions)(n.MediaCarousel,function e(t){switch(t){case"MOBILE":return{clientWidth:400,clientHeight:200};case"TABLET":return{clientWidth:425,clientHeight:350};case"DESKTOP":default:return{clientWidth:610,clientHeight:350}}}),oe=function(e){function t(){var e,a;W()(this,t);for(var i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return a=F()(this,(e=D()(t)).call.apply(e,[this].concat(r))),Q()(q()(q()(a)),"doAdjustPortraitPhotos",function(e){return"MOBILE"!==e}),Q()(q()(q()(a)),"isAlbumThinGeo",function(){return a.props.albumId&&a.props.albumId===n.AlbumTypes.THIN_GEO_PHOTO_ALBUM}),Q()(q()(q()(a)),"showIndicatorDots",function(){return"MOBILE"===a.props.viewportCategory}),Q()(q()(q()(a)),"renderPhotoCountOverlay",function(){var e="MOBILE"===a.props.viewportCategory?"xsmall":"regular",t=a.showIndicatorDots()?"none":void 0;return a.isAlbumThinGeo()?o.createElement(n.PhotoSource,{text:a.props.albumName||""}):a.props.totalMediaCount>1?o.createElement(n.PhotoCount,{onClick:function e(){u()({module:"photoviewer",action:"atf_allphotos_click",context:"".concat(a.props.locationId)}),b(a.props.locationId,a.props.geoId,n.AlbumTypes.ALL_ALBUMS,-1)},fontSize:e,icon:"camera-fill",totalCount:a.props.totalMediaCount,linkText:a.props.albumName||Object(Z.localize)("photos_module_carousel_view_all_photos_plain"),background:t}):null}),a}return V()(t,e),U()(t,[{key:"render",value:function e(){var t=this.props,a=t.locationId,i=t.geoId,r=t.media,l=t.totalMediaCount,s=t.getNextPage,c=t.carouselIndex,d=t.updateCarouselIndex,m=t.postPhotosUrl,h=t.writeReviewUrl,v=t.locationName,f=Math.max(Math.min(c,r.length-1),0),w=20*Math.floor(f/20),g=Math.min(w+20,r.length),_=r[f].mediaId&&!this.isAlbumThinGeo()?function(e){u()({module:"photoviewer",action:"atf_hero_click",context:"".concat(e)}),b(a,i,n.AlbumTypes.ALL_ALBUMS,e)}:null;return o.createElement("div",{className:p()("hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__carouselWrap--QMjPF",this.isAlbumThinGeo()?"hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__carouselWrapMobileThinGeo--JYJIG":"hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__carouselWrapMobileRegular--2PRvC","hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__carouselContainer--2YROw","hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__carousel-container--3QXmw"),key:"carousel-container"},o.createElement("div",{className:"hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__flexColumn--1ESad"},o.createElement(ae,{width:"100%",height:"100%",media:r,totalCount:l,uniqueId:"".concat(a),showIndicatorDots:this.showIndicatorDots(),onClick:_,onLoadLast:function e(){return"function"==typeof s&&s()},loadLastThreshold:19,onNextClick:function e(){u()({module:"photoviewer",action:"atf_hero_arrow_click"})},onPrevClick:function e(){u()({module:"photoviewer",action:"atf_hero_arrow_click"})},displayIndex:f,imageFitStrategy:this.doAdjustPortraitPhotos(this.props.viewportCategory)?"calculated":"cover",backgroundColor:"black",showCta:!!_,hideArrows:this.isAlbumThinGeo(),renderOverlay:!!_&&this.renderPhotoCountOverlay}),l>10&&o.createElement("div",{className:"hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__photoStripContainer--2sbFy"},o.createElement(n.Mediastrip,{media:r.slice(w,g),selectedIndex:f%20,onMediaSelected:function e(t){d("".concat(a),w+t),r.length!==l&&r.length-w-t<20&&"function"==typeof s&&s(),u()({module:"photoviewer",action:"atf_previewthumb_click"})},numItemsInRow:10})),this.isAlbumThinGeo()&&o.createElement("div",{className:"hotels-hotel-review-atf-photos-media-window-Carousel-CarouselWithThumbnails__ctaContainer--3baLk"},o.createElement(n.ThinGeoCTA,{postPhotosUrl:m||"/PostPhotos-d".concat(a),writeReviewUrl:h||"/UserReview-d".concat(a),locationName:v||""}))))}}]),t}(o.PureComponent);Q()(oe,"defaultProps",{getNextPage:function e(){}});var ne=Object(r.connect)(function(e,t){return{viewportCategory:e.meta.device.viewportCategory,carouselIndex:Object(n.getMediaCarouselState)(e).currentIndex["".concat(t.locationId)]||0}},{updateCarouselIndex:n.MEDIA_CAROUSEL_ACTIONS.updateCurrentIndex})(oe),ie=function(e){function t(){var e,a;W()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return a=F()(this,(e=D()(t)).call.apply(e,[this].concat(i))),Q()(q()(q()(a)),"renderCarousel",function(e){var t=e.loading,n=e.media,i=e.getNextPage,r=a.props,l=r.album,s=r.locationId,c=r.geoId,u=r.postPhotosUrl,d=r.writeReviewUrl,m=r.locationName,h=l.totalMediaCount,p=l.albumId,v=l.name;return!t||n&&h?n&&0!==h?o.createElement(ne,{locationId:s,geoId:c,media:n,totalMediaCount:h,getNextPage:i,albumId:p,albumName:v,postPhotosUrl:u,writeReviewUrl:d,locationName:m}):o.createElement(te,{locationId:s,geoId:c}):o.createElement(J.a,{height:"100%",width:"100%"})}),a}return V()(t,e),U()(t,[{key:"render",value:function e(){var t=this.props,a=t.loading,i=t.locationId,r=t.geoId,l=t.client,s=t.initOffset,c=t.album;if(a&&!c||!i)return o.createElement(J.a,{height:"100%",width:"100%"});if(!r)throw new Error("No geoId provided to CarouselPane");if(!c)return o.createElement(te,{locationId:i,geoId:r});var u=c.totalMediaCount,d=c.albumId,m=c.mediaList,h=c.dataStrategy;return o.createElement(n.AlbumPagingProvider,{locationId:i,albumId:d,client:l,dataStrategy:h,filter:Object(X.getMediaFilterToRetrieveAllPhotos)(),initMedia:m,initOffset:s,totalMediaCount:u,pageSize:20,uniqueId:"".concat(i),render:this.renderCarousel})}}]),t}(o.PureComponent),re=function e(t){var a=t.renderCarouselPane,n=t.renderAlbumPane,i=t.renderBadge,r=a(),l=n(),s=i();return o.createElement("div",{className:p()("hotels-hotel-review-atf-photos-media-window-AtfWindow__fullHeight--2G86v","hotels-hotel-review-atf-photos-media-window-AtfWindow__mediaWindow--1YklV")},r,l,s)};a.d(t,"ssrQueries",function(){return he});var le={ROOT_FIELDS:[],LOCATION_FIELDS:[],SSR_QUERIES:[]},se=Object(n.connectBadge)(le),ce=function e(t,a,o){return Object(r.connect)(function(e,n){var i=n.location,r=n.windowPanes,l=n.loading,c=s()(i,"locationId",null)||s()(e,"page.detailId",null)||s()(e,"page.transData.location.locationId",0);return{locationId:c,album:s()(r,"[".concat(t,"].albums[0]"),s()(e,"page.transData.album",null)),geoId:s()(e,"page.geoId",0),client:a,initOffset:o,loading:l,postPhotosUrl:s()(i,"postPhotosUrl","/PostPhotos-d".concat(c)),writeReviewUrl:s()(i,"writeUserReviewUrl","/UserReview-d".concat(c)),locationName:s()(i,"name",null)}})(ie)}(0,"hra",20),ue=function e(t,a){return t.LOCATION_FIELDS.push(Object(m.getFragment)(S,"TravelerAlbumAvatars")),Object(r.connect)(function(e,t){var o=t.location,n=t.windowPanes,i=t.loading;return{albums:s()(n,"[".concat(a,"].albums"),null),locationId:s()(o,"locationId",0),avatarData:s()(o,"travelerAlbum[0].photos",null),geoId:e.page.geoId,loading:i}})(L)}(le,1),de=function e(t,a){return function e(t){return o.createElement(re,{renderCarouselPane:function e(){return a.carouselPane(t)},renderAlbumPane:function e(){return a.albumPane(t)},renderBadge:function e(){return a.badge(t)}})}}(0,{carouselPane:function e(t){return o.createElement(ce,t)},albumPane:function e(t){return o.createElement(ue,t)},badge:function e(t){return o.createElement(se,t)}}),me=Object(n.connectMediaWindowContainer)(le,"hra",Object(i.getConfigurationForHrAtfMediaWindow)(),function(e){return o.createElement(de,e)}),he=(t.default=me,function e(t){return le.SSR_QUERIES.map(function(e){return e(t)})})}}});
//# sourceMappingURL=hotels.hotel-review-atf-photos-media-window.68dfca8691.js.map