(window.$WP=window.$WP||[]).push({id:"@ta/hotels.question-answer-parts",d:["@ta/common.ajax","ta-platform","vendor-babel","vendor-react-libs","vendor-apollo-libs","ta-common","@ta/overlays.managers","@ta/overlays.modal","@ta/hotels.review-list-parts"],e:["./packages/hotels/question-answer-parts/question-answer-parts.jsx"],x:{"./packages/hotels/question-answer-parts/AuthGated.jsx":["a"],"./packages/hotels/question-answer-parts/question-answer-parts.jsx":["answersAjax","AnswerProvider","AuthGated","PostingGuidelinesLink","TranslateModal"]},m:{"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./packages/hotels/question-answer-parts/AuthGated.jsx":function(e,t,n){"use strict";(function(e){var a=n("@babel/runtime/helpers/esm/objectSpread"),s=n.n(a),o=(n("react"),n("react-redux"));t.a=Object(o.connect)(function(e,t){return s()({},t,{loggedInUserId:e.auth.loggedInUserId,csrfToken:e.auth.csrfToken,altSessId:e.auth.altSessId,isMobile:"MOBILE"===e.meta.device.viewportCategory})})(function t(n){var a=n.loggedInUserId,s=n.csrfToken,o=n.altSessId,i=n.call,r=n.isMobile;return(0,n.children)(function(){if(a)i({csrfToken:s,altSessId:o});else{var t={flow:"CORE_COMBINED",pid:-1,userRequestedForce:!0,onSuccess:function e(){return i({csrfToken:s,altSessId:o})}};e.require(["trjs!ta/registration/RegOverlay"],function(e){return e.showRegOverlay(null,null,r,t)})}})})}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./packages/hotels/question-answer-parts/question-answer-parts.jsx":function(e,t,n){"use strict";n.r(t);var a=n("@ta/common.ajax"),s=n("@ta/common.tracking"),o=n.n(s),i=function e(t,n){t&&fetch("/AnswersAjax",{credentials:"same-origin",method:"POST",body:Object(a.formEncode)(t),headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}}).then(n)},r=function e(t,n,a,s){var r={altsessid:a.altSessionId||"",act:"av",pstid:n,vs:t,pid:-1,token:a.csrfToken,useJson:!0};i(r,s),o()({module:"faq",action:"click",context:1===t?"upvote":"downvote"})},l={submitAnswer:function e(t){var n=t.locationId,a=t.topicId,s=t.text,o=t.requestValidation,r=t.onResponse;if(s){var l={act:"ap",psttxt:s,tpcid:a,pid:-1,altsessid:o.altSessionId,token:o.csrfToken,lcid:n,"g-recaptcha-response":o.captchaResponse.token,geetest_challenge:o.captchaResponse.challenge,geetest_validate:o.captchaResponse.validate,geetest_seccode:o.captchaResponse.seccode,useJson:!0};i(l,r)}},submitQuestion:function e(t){var n=t.locationId,a=t.text,s=t.optIn,o=t.redirect,r=t.requestValidation,l=t.onResponse;if(a){var c={act:s?"ats":"at",topicText:a,detail:n,pid:-1,optIn:s,altsessid:r.altSessionId,token:r.csrfToken,"g-recaptcha-response":r.captchaResponse.token,geetest_challenge:r.captchaResponse.challenge,geetest_validate:r.captchaResponse.validate,geetest_seccode:r.captchaResponse.seccode,redirect:o};i(c,l)}},deleteAnswer:function e(t){var n=t.id,a=t.token,s=t.onResponse;n&&i({act:"dp",pstid:n,token:a},s)},deleteQuestion:function e(t){var n=t.id,a=t.token,s=t.onResponse;n&&i({act:"dt",tpcid:n,token:a},s)},upVote:function e(t){var n=t.postingId,a=t.requestValidation,s=t.onResponse;r(1,n,a,s)},downVote:function e(t){var n=t.postingId,a=t.requestValidation,s=t.onResponse;r(-1,n,a,s)}},c=n("@babel/runtime/helpers/esm/toConsumableArray"),u=n.n(c),d=n("react"),p=n("react-apollo"),g=function e(t){var n=t.topic,a=t.query,s=t.children,o=t.expanded,i=t.newPostingId,r=!(!i||n.topPosting&&n.topPosting.id===i),l=n.topPosting?[n.topPosting]:[];return d.createElement(p.Query,{query:a,variables:{fetchTopic:o,fetchPosting:r,topicId:o?n.id:null,postingId:i},errorPolicy:"all",fetchPolicy:"network-only"},function(e){var t=e.loading,a=e.data;if(t&&o){var i=[n.topPosting];return r&&i.unshift(null),o&&i.push.apply(i,u()(Array(n.postCount-1).fill(null))),s(i)}if(!a)return s(l);var c=r&&a.postings&&a.postings[0]?a.postings[0]:null,d=o&&a.topics&&a.topics[0]?a.topics[0].postings:l;return s(o||r?c?[c].concat(u()(d.filter(function(e){return e&&e.id!==c.id}))):d:d.length>0?[d[0]]:[])})},m=n("./packages/hotels/question-answer-parts/AuthGated.jsx"),h=n("@babel/runtime/helpers/esm/classCallCheck"),f=n.n(h),v=n("@babel/runtime/helpers/esm/createClass"),w=n.n(v),b=n("@babel/runtime/helpers/esm/possibleConstructorReturn"),_=n.n(b),k=n("@babel/runtime/helpers/esm/getPrototypeOf"),j=n.n(k),I=n("@babel/runtime/helpers/esm/inherits"),q=n.n(I),x=n("@babel/runtime/helpers/esm/assertThisInitialized"),y=n.n(x),E=n("@babel/runtime/helpers/esm/defineProperty"),P=n.n(E),O=n("@ta/common.i18n"),T=n("@ta/styleguide.icon"),G=n("@ta/common.routing"),R=function e(t){return d.createElement("ul",null,d.createElement("li",{className:"hotels-question-answer-parts-PostingGuidelinesList__item--3wj_r"},Object(O.localize)("qa_guidelines_relevant_visit",{loc_name:t.location.geoName})),d.createElement("li",{className:"hotels-question-answer-parts-PostingGuidelinesList__item--3wj_r"},Object(O.unescaped)(Object(O.localize)("qa_guidelines_forums_new_tab",{forum_link:Object(G.buildUrl)({page:"ShowForum",g:t.location.parentGeoId})}))),d.createElement("li",{className:"hotels-question-answer-parts-PostingGuidelinesList__item--3wj_r"},Object(O.localize)("qa_guidelines_objective")),d.createElement("li",{className:"hotels-question-answer-parts-PostingGuidelinesList__item--3wj_r"},Object(O.localize)("qa_guidelines_links")),d.createElement("li",{className:"hotels-question-answer-parts-PostingGuidelinesList__item--3wj_r"},Object(O.unescaped)(Object(O.localize)("qa_guidelines_adhere_new_tab",{help_link:"https://www.tripadvisorsupport.com/hc/articles/201996887"}))))},A={guidelinesControl:"hotels-question-answer-parts-PostingGuidelinesLink__guidelinesControl--3gjtK",community:"hotels-question-answer-parts-PostingGuidelinesLink__community--3dIF_",linkText:"hotels-question-answer-parts-PostingGuidelinesLink__linkText--1hABE"},L=function(e){function t(){var e,n;f()(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return n=_()(this,(e=j()(t)).call.apply(e,[this].concat(s))),P()(y()(y()(n)),"state",{expand:!1}),P()(y()(y()(n)),"openGuidelineOverlay",function(){var e=n.props.location;require(["trjs!overlays/widgetoverlays"],function(t){return t.showLightbox("QA_POSTING_GUIDELINES",{locationId:e},{})})}),P()(y()(y()(n)),"toggleExpansion",function(){n.setState(function(e){return{expand:!e.expand}})}),n}return q()(t,e),w()(t,[{key:"render",value:function e(){var t=this.props,n=t.theme,a=t.location,s=t.inlineExpansion,o=this.state.expand,i=n&&A[n]||A.guidelinesControl,r=o?"caret-up":"caret-down";return d.createElement(d.Fragment,null,d.createElement("div",{className:i,onClick:s?this.toggleExpansion:this.openGuidelineOverlay},d.createElement("span",{className:A.linkText},Object(O.localize)("qa_posting_guidelines")),s?d.createElement(T.Icon,{name:r}):null),o?d.createElement(R,{location:a}):null)}}]),t}(d.Component);P()(L,"defaultProps",{theme:void 0,inlineExpansion:!1});var S=L,C=n("react-redux"),M=n("@ta/overlays.managers"),N=n("@ta/overlays.modal"),z=n("@ta/styleguide.loading"),F=n("@ta/hotels.review-list-parts"),U=function e(t){var n=t.locationId,s=t.topicId,o=t.postingId,i=t.contentLanguage,r=t.pageLanguage,l=t.children;if(i===r)return null;var c,u=function p(e){return e.replace(/^zh/,"zh-")}(i),g=["toverlay",n,s,o,u,r].join("-");return c=o?"/MachineTranslation?g=0&d=".concat(n,"&t=").concat(s,"&lp=").concat(o,"&page=posting&sl=").concat(u,"&tl=").concat(r):"/MachineTranslation?g=0&d=".concat(n,"&t=").concat(s,"&page=topic&sl=").concat(u,"&tl=").concat(r),d.createElement(d.Fragment,null,d.createElement(M.Opener,{name:g},l),d.createElement(N.Modal,{name:g},d.createElement(a.AjaxRequest,{url:c},function(e){var t=e.loading,n=e.data;return t?d.createElement(z.LoadingSpinner,null):d.createElement("div",{className:"hotels-question-answer-parts-TranslateModal__translateModal--3kbc1",dangerouslySetInnerHTML:{__html:n}})})))};U.defaultProps={postingId:void 0};var V=Object(C.connect)(function(e){return{pageLanguage:Object(F.contentLangFromState)(e)}})(U);n.d(t,"answersAjax",function(){return l}),n.d(t,"AnswerProvider",function(){return g}),n.d(t,"AuthGated",function(){return m.a}),n.d(t,"PostingGuidelinesLink",function(){return S}),n.d(t,"TranslateModal",function(){return V})}}});
//# sourceMappingURL=hotels.question-answer-parts.d71298be8b.js.map