(window.$WP=window.$WP||[]).push({id:"@ta/hotels.community-content-common",d:["vendor-react-libs","ta-platform","@ta/common.grid","vendor-apollo-libs","ta-common","@ta/common.cookie","@ta/overlays.managers","@ta/hotels.question-answer-parts","vendor-babel","@ta/events.event-boundary","@ta/overlays.popover","@ta/hotels.review-list-parts","@ta/hotels.hotel-review-layout","@ta/styleguide.grouping-tabs","@ta/styleguide.skeleton"],e:["./packages/hotels/community-content-common/index.jsx"],x:{"./packages/hotels/community-content-common/index.jsx":["LowContentCTA","ContextualCTA","TabBarAboveHeader","createTabBarQueries","HEADER_SCROLL_OFFSET","H_R_CONTENT_COLLECTION_PID","QUESTION_FORM_MODAL_NAME","scrollIntoView","default"]},m:{"./packages/hotels/community-content-common/index.jsx":function(e,t,n){"use strict";n.r(t);var o=n("react"),a=n("@ta/common.classnames"),i=n.n(a),c=n("@ta/common.grid"),l=n("@ta/common.features"),r=n("react-apollo"),s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CommunityContent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentGeoId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"writeUserReviewUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topicsUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"postPhotosUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"currentUserOwnerStatus"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isValid"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"roomTipsCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topicCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reviewSummary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:298}};s.loc.source={body:"c1c809123f75"};var u=s,m={loading:!0,writeUserReviewUrl:"",topicsUrl:"",postPhotosUrl:"",roomTipsCount:0,questionsCount:0,reviewsCount:0,hasNoContent:!1,isActiveOwner:!1,locationId:0,geoId:0},d=o.createContext(m),_=d.Consumer,v=d.Provider,b=function e(t){return{query:u,variables:{locationId:t},errorPolicy:"all",skip:!t||t<0}},p=function e(t){var n=t.locationId,a=t.children,i=b(n);return o.createElement(r.Query,{query:i.query,variables:i.variables,errorPolicy:i.errorPolicy,skip:i.skip},function(e){var t,n=e.loading,i=e.data;if(!n&&i&&i.locations&&i.locations[0]){var c,l,r=i.locations[0],s=r.topicCount||0,u=(null===(c=r.reviewSummary)||void 0===c?void 0:c.count)||0;t={loading:n,writeUserReviewUrl:r.writeUserReviewUrl||"",topicsUrl:r.topicsUrl||"",postPhotosUrl:r.postPhotosUrl||"",roomTipsCount:r.roomTipsCount||0,questionsCount:s,reviewsCount:u,hasNoContent:0===s&&0===u,isActiveOwner:(null===(l=r.currentUserOwnerStatus)||void 0===l?void 0:l.isValid)||!1,locationId:r.locationId,geoId:r.parentGeoId}}else t=m;return o.createElement(v,{value:t},a)})},h=n("@ta/common.i18n"),f=n("@ta/common.tracking"),k=n("@ta/styleguide.button"),C=n.n(k),w=n("react-redux"),E=n("@ta/common.cookie"),y=function e(t,n){t&&t>0&&Object(E.setPIDCookie)(t,n)},T=function e(t){var n=t.locationId,a=t.geoId,i=t.writeUserReviewUrl,c=t.className,l=t.pid,r=t.cookieDomain,s=t.children;if(n<=0||a<=0)return null;var u=i||"/UserReview-g".concat(a,"-d").concat(n);return o.createElement("a",{href:u,target:"_blank",className:c,onClick:l?y(l,r):""},s)};T.defaultProps={className:""};var g=Object(w.connect)(function(e){return{cookieDomain:e.meta.cookieDomain}})(T),I=n("@ta/styleguide.icon"),O=function e(t){return o.createElement(c.Column,{width:4},o.createElement("div",{className:"hotels-community-content-common-ContentCollectionCTA__CTAContainer--3wrMF"},o.createElement(I.Icon,{name:t.icon,className:"hotels-community-content-common-ContentCollectionCTA__icon--16mqp"}),o.createElement("div",{className:"hotels-community-content-common-ContentCollectionCTA__title--2vdMr"},t.title),o.createElement("div",{className:"hotels-community-content-common-ContentCollectionCTA__subtitle--3rzck"},t.subtitle),t.children))},N=function e(){return o.createElement(_,null,function(e){var t=e.locationId,n=e.geoId,a=e.writeUserReviewUrl;return o.createElement(O,{icon:"pencil-paper",title:Object(h.localize)("hr_write_your_review"),subtitle:Object(h.localize)("hr_write_your_review_sub_title")},o.createElement(f.Track,{click:{module:"low_content_collection_cta_review",action:"start_submission",context:"POI|Hotel",dstServlet:"UserReviewEdit",value:0,once:!0},element:"span"},o.createElement(g,{locationId:t,geoId:n,writeUserReviewUrl:a,pid:Ie},o.createElement(C.a,{type:"primary"},Object(h.localize)("hr_write_a_review")))))})},x=function e(t,n,o,a,i){n<0||t<0||(Object(E.setPIDCookie)(a,i),Object(f.trackEventCookie)({module:o,action:"start_submission",context:"POI|Hotel",value:0,destinationUrl:"/PostPhotos"}),window.open("/PostPhotos-g".concat(t,"-d").concat(n)))},A=Object(w.connect)(function(e){return{cookieDomain:e.meta.cookieDomain}})(function e(t){return o.createElement(_,null,function(e){var n=e.geoId,a=e.locationId,i=e.postPhotosUrl;return o.createElement(O,{icon:"camera-fill",title:Object(h.localize)("hr_share_your_photo"),subtitle:Object(h.localize)("hr_share_your_photo_subtitle_period")},o.createElement("a",{href:i,target:"_blank",onClick:function e(t){return t.preventDefault()}},o.createElement(C.a,{type:"primary",onClick:function e(){return x(n,a,"low_content_collection_cta_photo",Ie,t.cookieDomain)}},Object(h.localize)("hr_post_a_photo"))))})}),R=n("@ta/overlays.managers"),j=n("@ta/hotels.question-answer-parts"),U=function e(){return o.createElement(_,null,function(e){var t=e.topicsUrl;return o.createElement(O,{icon:"forums",title:Object(h.localize)("hr_get_answers"),subtitle:Object(h.localize)("hr_get_answer_subtitle")},o.createElement(R.Opener,{name:Oe},function(e){return o.createElement(j.AuthGated,{call:e},function(e){return o.createElement(f.Track,{click:{module:"low_content_collection_cta_question",action:"start_submission",context:"POI|Hotel",value:0,once:!0},element:"span"},o.createElement("a",{href:"".concat(t,"#AskQuestionForm"),target:"_blank",onClick:function e(t){return t.preventDefault()}},o.createElement(C.a,{type:"primary",onClick:e},Object(h.localize)("hr_ask_a_question"))))})}))})},S=function e(t){return o.createElement(p,{locationId:t.locationId},o.createElement(_,null,function(e){var n=e.loading,a=e.isActiveOwner,r=e.questionsCount,s=e.reviewsCount,u=e.roomTipsCount,m=5;switch(t.selectedTab){default:case"Reviews":m=s;break;case"Questions":m=r;break;case"RoomTips":m=u}return n||a||m>=5&&0!==s?null:o.createElement("div",{className:i()("ui_card","section","hotels-community-content-common-LowContentCTA__CTARow--1b6Du",0===s?"hotels-community-content-common-LowContentCTA__noReviews--1Hksy":""),"data-test-target":"low_content_cta"},o.createElement(c.Columns,{gaplessVertical:!0},o.createElement(N,null),o.createElement(A,null),Object(l.featureIsEnabled)("hotel_review_questions")&&o.createElement(U,null)))}))},q=n("@babel/runtime/helpers/esm/slicedToArray"),z=n.n(q),P=n("@ta/common.is-visible"),D=n("@ta/events.event-boundary"),F=n.n(D),Q=n("@ta/failover.readonly"),H=n("@ta/overlays.popover"),L=n.n(H),B=n("@ta/hotels.review-list-parts"),V=n("@ta/common.radio"),M=n.n(V),G=Object(w.connect)(function(e){return{cookieDomain:e.meta.cookieDomain}})(function e(t){var n=o.useState(!1),a=z()(n,2),i=a[0],c=a[1],r=Object(P.useOnVisible)(function(){fetch("/data/1.0/draftreviews/hasDraft/".concat(t.locationId),{method:"GET",credentials:"same-origin"}).then(function(e){if(e.ok)return e.json();throw Error()}).then(function(e){return c(e)}).catch(function(){return!1})},[],0,1),s=function e(){return i?Object(h.localize)("hotel.review.finish.review_fffff216"):Object(h.localize)("hr_write_a_review")},u={Reviews:function e(){return o.createElement(_,null,function(e){var n=e.writeUserReviewUrl;return o.createElement(o.Fragment,null,o.createElement(B.PointsCampaign,{locationId:t.locationId}),o.createElement(f.Track,{click:{module:"content_submission|review",action:"start_submission",context:"POI|Hotel",dstServlet:"UserReviewEdit",value:0,once:!0},element:"span"},o.createElement(g,{locationId:t.locationId,geoId:t.geoId,writeUserReviewUrl:n,pid:40537,className:"ui_button primary war-button"},s())))})},Photos:function e(){return o.createElement(C.a,{type:"primary",onClick:function e(){return x(t.geoId,t.locationId,"content_submission|photo",40537,t.cookieDomain)}},Object(h.localize)("hr_post_a_photo"))},Questions:function e(){return Object(l.featureIsEnabled)("hotel_review_questions")?o.createElement(R.Opener,{name:Oe},function(e){return o.createElement(j.AuthGated,{call:e},function(e){return o.createElement(f.Track,{click:{module:"content_submission|question",action:"start_submission",context:"POI|Hotel",value:0,once:!0},element:"span"},o.createElement(C.a,{type:"primary",onClick:function t(){M()("hr-community-tab").emit("selectTab","Questions",!0),e()}},Object(h.localize)("hr_ask_a_question")))})}):null}},m={Reviews:function e(){return o.createElement(_,null,function(e){var n=e.writeUserReviewUrl;return o.createElement(f.Track,{click:{module:"contextual_cta_dropdown_review",action:"start_submission",context:"POI|Hotel",dstServlet:"UserReviewEdit",value:0,once:!0},element:"span"},o.createElement(g,{locationId:t.locationId,geoId:t.geoId,writeUserReviewUrl:n,pid:40537,className:"hotels-community-content-common-ContextualCTA__link--1kgks"},o.createElement(I.Icon,{name:"pencil-paper",className:"hotels-community-content-common-ContextualCTA__icon--1rqtt"}),o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__linkText--3zIxv"},s())))})},Photos:function e(){return o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__link--1kgks",onClick:function e(){return x(t.geoId,t.locationId,"contextual_cta_dropdown_photo",40537,t.cookieDomain)}},o.createElement(I.Icon,{name:"camera-fill",className:"hotels-community-content-common-ContextualCTA__icon--1rqtt"}),o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__linkText--3zIxv"},Object(h.localize)("hr_post_a_photo")))},Questions:function e(){return Object(l.featureIsEnabled)("hotel_review_questions")?o.createElement(R.Opener,{name:Oe},function(e){return o.createElement(j.AuthGated,{call:e},function(e){return o.createElement(f.Track,{click:{module:"contextual_cta_dropdown_question",action:"start_submission",context:"POI|Hotel",value:0,once:!0},element:"span"},o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__link--1kgks",onClick:function t(){M()("hr-community-tab").emit("selectTab","Questions",!0),e()}},o.createElement(I.Icon,{name:"forums",className:"hotels-community-content-common-ContextualCTA__icon--1rqtt"}),o.createElement("span",{className:"hotels-community-content-common-ContextualCTA__linkText--3zIxv"},Object(h.localize)("hr_ask_a_question"))))})}):null}},d=function e(t){var n=t.selectedTab;return(n&&"RoomTips"!==n&&u[n]||u.Reviews)()},v=function e(t){var n=t.locationId;return o.createElement(f.Track,{click:{module:"owner_cta",action:"owner_visit_mc_middle",context:n.toString(),value:0,once:!0}},o.createElement("a",{href:"/ManagementCenter-d".concat(n)},o.createElement(C.a,{type:"primary"},Object(h.localize)("restaurant_owners_visit_your_owner_mangement_center"))))},b=function e(){return o.createElement(f.Track,{click:{module:"contextual_cta_dropdown_toggle",action:"open",context:"POI|Hotel",value:0,once:!0}},o.createElement(L.a,{below:!0,fullBleed:!0,local:!0,arrowType:"none",closeButton:!1,alignEdge:"right",contents:function e(t){return o.createElement(o.Fragment,null,Object.keys(m).map(function(e){return o.createElement("div",{className:"hotels-community-content-common-ContextualCTA__option--zhK3I",key:e,onClick:t},m[e]())}))}},function(e,t,n,a){return o.createElement(F.a,{events:["onClick","onTouchStart"]},o.createElement("div",{ref:e,className:"hotels-community-content-common-ContextualCTA__dropdownArrow--knz7a",onClick:a?n:t},o.createElement(I.Icon,{name:a?"caret-up":"caret-down"})))}))};return o.createElement(Q.HideOnReadonly,null,o.createElement(_,null,function(e){var n=e.loading,a=e.hasNoContent,i=e.isActiveOwner;return n||a?null:i?o.createElement(v,{locationId:t.locationId}):o.createElement("div",{ref:r,className:"hotels-community-content-common-ContextualCTA__contextualCTA--3K7gq"},o.createElement("div",{className:"hotels-community-content-common-ContextualCTA__currentButton--1Qi0g","data-test-target":"ugc_cta_button"},o.createElement(d,{selectedTab:t.selectedTab}),o.createElement(b,null)))}))}),W=n("@ta/common.api"),K=n("@ta/hotels.hotel-review-layout"),$=n("@ta/styleguide.grouping-tabs"),J=function e(){return o.createElement(_,null,function(e){var t=e.topicsUrl,n=e.questionsCount;return n>3?o.createElement("a",{href:t,target:"_blank",className:"hotels-community-content-common-SeeAllQuestionsLink__see_all_link--109hE"},Object(h.localize)("qa_see_all_n_questions",{nQuestions:n})):null})},X=n("@babel/runtime/helpers/esm/extends"),Y=n.n(X),Z=n("@babel/runtime/helpers/esm/objectSpread"),ee=n.n(Z),te=n("@babel/runtime/helpers/esm/classCallCheck"),ne=n.n(te),oe=n("@babel/runtime/helpers/esm/createClass"),ae=n.n(oe),ie=n("@babel/runtime/helpers/esm/possibleConstructorReturn"),ce=n.n(ie),le=n("@babel/runtime/helpers/esm/getPrototypeOf"),re=n.n(le),se=n("@babel/runtime/helpers/esm/inherits"),ue=n.n(se),me=n("@babel/runtime/helpers/esm/assertThisInitialized"),de=n.n(me),_e=n("@babel/runtime/helpers/esm/defineProperty"),ve=n.n(_e),be=n("@ta/styleguide.skeleton"),pe=n.n(be),he="hotels-community-content-common-TabBar__tabCount--1vwdQ",fe="hotels-community-content-common-TabBar__typeText--3kWRj",ke=new Set(["Questions","RoomTips"]),Ce=function(e){function t(){var e,n;ne()(this,t);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=ce()(this,(e=re()(t)).call.apply(e,[this].concat(a))),ve()(de()(de()(n)),"state",{defaultTabCheckCompleted:!1}),n}return ue()(t,e),ae()(t,[{key:"componentDidUpdate",value:function e(){this.state.defaultTabCheckCompleted||this.defaultTabCheck()}},{key:"defaultTabCheck",value:function e(){var t=this.props.context,n=t.loading,o=t.hasNoContent,a=t.questionsCount,i=t.reviewsCount;n||(this.setState({defaultTabCheckCompleted:!0}),!o&&0===i&&a>0&&this.props.setSelectedTab("Questions"))}},{key:"render",value:function e(){var t=this.props.context,n=t.loading,a=t.hasNoContent,i=t.questionsCount,c=t.reviewsCount,r=t.roomTipsCount,s=this.props,u=s.selectedTab,m=s.children;if(a)return null;if(n)return o.createElement(pe.a,{height:"120px"});var d={selectedTab:u},_=[ee()({tab:"Reviews",icon:"pencil-paper",count:c,label:Object(h.localize)("hr_community_tab_reviews",{countClass:he,typeClass:fe,count:h.globalize.formatNumber("integer",c)})},d),ee()({tab:"Questions",icon:"forums",count:i,label:Object(h.localize)("hr_community_tab_questions_2",{countClass:he,typeClass:fe,count:h.globalize.formatNumber("integer",i)})},d),ee()({tab:"RoomTips",icon:"lightbulb-on",count:r,label:Object(h.localize)("hr_community_tab_room_tips",{countClass:he,typeClass:fe,count:h.globalize.formatNumber("integer",r)})},d)];return m(Object(l.featureIsEnabled)("hotel_review_questions")?_:_.filter(function(e){return"Questions"!==e.tab}))}}]),t}(o.Component),we=function e(t){return o.createElement(_,null,function(e){return o.createElement(Ce,Y()({},t,{context:e}),t.children)})},Ee=function e(t){switch(t){case"Reviews":return Object(h.localize)("common_Reviews");case"Questions":return Object(h.localize)("mobile_questions_answers");case"RoomTips":return Object(h.localize)("tabs_room_tips_title_fffff661");default:return""}},ye=function e(t,n){return[Object(B.createConnectionReviewsQuery)(t,n),b(n)]},Te=Object(W.bind)(function(e,t){return B.SensitiveIssuesBadge.stage(e,t),function(e,t){return t}})(function e(t){return o.createElement(p,{locationId:t.locationId},o.createElement(K.Section,{section:"reviews",theme:"none"},o.createElement($.GroupingTabs,null,o.createElement(we,t,function(e){return e.map(function(e){return o.createElement($.GroupingTab,{active:e.tab===t.selectedTab,key:e.tab,onClick:e.count>0?function(){return t.setSelectedTab(e.tab,!0)}:function(){return!1},className:"hotels-community-content-common-TabAboveHeader__tab--2IBb2"},o.createElement("div",{className:i()(e.count>0?null:"hotels-community-content-common-TabAboveHeader__inactive--a3nEx")},o.createElement(I.Icon,{name:e.icon,className:"hotels-community-content-common-TabAboveHeader__icon--z0-Ex"}),Object(h.unescaped)(e.label)))})}))),o.createElement(K.Section,{theme:"tabbed-top",joinable:!ke.has(t.selectedTab)},o.createElement(K.ComplexHeader,{text:o.createElement(o.Fragment,null,Ee(t.selectedTab),"Reviews"===t.selectedTab?o.createElement(B.ReviewControlNotice,null):null,"Questions"===t.selectedTab?o.createElement(J,null):null),noDivider:ke.has(t.selectedTab)},o.createElement(G,{selectedTab:t.selectedTab,locationId:t.locationId,geoId:t.geoId})),o.createElement(B.SensitiveIssuesBadge,null),"Reviews"===t.selectedTab?o.createElement(B.ConnectionReviewsCTA,{locationId:t.locationId}):null))});n.d(t,"HEADER_SCROLL_OFFSET",function(){return ge}),n.d(t,"H_R_CONTENT_COLLECTION_PID",function(){return Ie}),n.d(t,"QUESTION_FORM_MODAL_NAME",function(){return Oe}),n.d(t,"scrollIntoView",function(){return Ne}),n.d(t,"LowContentCTA",function(){return S}),n.d(t,"ContextualCTA",function(){return G}),n.d(t,"TabBarAboveHeader",function(){return Te}),n.d(t,"createTabBarQueries",function(){return ye});var ge=66,Ie=40537,Oe="community_qa_question_form",Ne=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=document.querySelector("#REVIEWS"),o=document.querySelector("body");if(o&&n){var a=o.getBoundingClientRect().top;window.scrollTo(0,n.getBoundingClientRect().top-a-t)}};t.default={}}}});
//# sourceMappingURL=hotels.community-content-common.09a5b59b45.js.map