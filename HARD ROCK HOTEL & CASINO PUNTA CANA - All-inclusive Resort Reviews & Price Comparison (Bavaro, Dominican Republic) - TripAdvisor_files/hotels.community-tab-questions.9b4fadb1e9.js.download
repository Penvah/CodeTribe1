(window.$WP=window.$WP||[]).push({id:"@ta/hotels.community-tab-questions",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","@ta/common.state-controller","@ta/social.skeletons","ta-platform","@ta/hotels.community-pagination-card","@ta/overlays.headers","@ta/overlays.managers","@ta/overlays.modal","@ta/hotels.community-content-common","ta-common","@ta/input.text-area","@ta/common.captcha","@ta/hotels.question-answer-parts","@ta/common.text","@ta/social.member-event","@ta/styleguide.skeleton","@ta/hotels.community-tab-common","@ta/overlays.attached-arrow-overlay","@ta/overlays.pieces","@ta/events.window"],e:["./packages/hotels/community-tab-questions/community-tab-questions.jsx"],x:{"./packages/hotels/community-tab-common/fragments/MemberFields.fragment.gql":["a"],"./packages/hotels/community-tab-questions/community-tab-questions.jsx":["default"]},m:{"./packages/hotels/community-tab-common/fragments/MemberFields.fragment.gql":function(e,n,t){"use strict";var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"PhotoSizesTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PhotoSize"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isHorizontal"},arguments:[],directives:[]}]}}],loc:{start:0,end:86}};i.loc.source={body:"a185bc5d5550"};var a=i,o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MemberFieldsTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MemberProfile"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"userId"},name:{kind:"Name",value:"id"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"static"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"isMe"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isVerified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isFollowing"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoSizesTabFragment"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"hometown"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fallbackString"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additionalNames"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"long"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"contributionCounts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sumAllUgc"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"helpfulVote"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"route"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:471}};o.loc.source={body:"ca7d6b012deb"};var s={};o.definitions=o.definitions.concat(function r(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!s[n]&&(s[n]=!0,!0)})}(a.definitions)),n.a=o},"./packages/hotels/community-tab-questions/community-tab-questions.jsx":function(e,n,t){"use strict";t.r(n);var i=t("@babel/runtime/helpers/esm/objectSpread"),a=t.n(i),o=t("@babel/runtime/helpers/esm/classCallCheck"),s=t.n(o),r=t("@babel/runtime/helpers/esm/createClass"),l=t.n(r),d=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),m=t.n(d),c=t("@babel/runtime/helpers/esm/getPrototypeOf"),u=t.n(c),v=t("@babel/runtime/helpers/esm/inherits"),k=t.n(v),p=t("@babel/runtime/helpers/esm/assertThisInitialized"),g=t.n(p),f=t("@babel/runtime/helpers/esm/defineProperty"),b=t.n(f),N=t("@babel/runtime/helpers/esm/slicedToArray"),h=t.n(N),y=t("react"),F=t("react-apollo"),S=t("react-redux"),_=t("@ta/common.state-controller"),w=t("@ta/social.skeletons"),E=t("@ta/common.tracking"),I=t.n(E),T=t("@ta/hotels.community-pagination-card"),A=t.n(T),q=t("@ta/common.is-visible"),C=t("@ta/common.radio"),V=t.n(C),j=t("@ta/common.i18n"),x=t("@ta/common.text"),D=t("@ta/common.routing"),M=t("@ta/social.member-event"),O=t("@ta/styleguide.skeleton"),P=t.n(O),z=t("@ta/hotels.question-answer-parts"),R=t("@ta/failover.readonly"),L=t("@ta/hotels.community-tab-common"),Q=t("@ta/common.captcha"),B=t("@ta/common.classnames"),U=t.n(B),G=t("@ta/styleguide.avatar"),H=t("@ta/input.text-area"),W=t("@ta/styleguide.button"),Y=t.n(W),J=t("@ta/styleguide.loading"),Z={text:"",errors:null,submitting:!1,answering:!1},$=function(e){function n(){var e,t;s()(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t=m()(this,(e=u()(n)).call.apply(e,[this].concat(o))),b()(g()(g()(t)),"state",a()({},Z)),b()(g()(g()(t)),"onChange",function(e){return t.setState({text:e.currentTarget.value})}),b()(g()(g()(t)),"onFocus",function(){I()({module:"faq",action:"click",context:"answers_faq_answer_form"}),t.setState({answering:!0})}),b()(g()(g()(t)),"onSubmitResponse",function(e){t.setState({submitting:!1}),e.ok&&t.props.onSubmit?(t.props.onSubmit(e),t.setState(a()({},Z))):e.json().then(function(e){t.resetCaptcha(),t.setState({errors:e.errors})})}),b()(g()(g()(t)),"submitAnswer",function(e){if(t.state.text){t.setState({submitting:!0});var n=t.props.topic,i=n.locationId,o=n.id,s=t.state.text,r=a()({},e,{captchaResponse:t.captchaResponse});z.answersAjax.submitAnswer({locationId:i,topicId:o,text:s,requestValidation:r,onResponse:t.onSubmitResponse})}}),b()(g()(g()(t)),"captchaResponse",{}),b()(g()(g()(t)),"resetCaptcha",function(){}),t}return k()(n,e),l()(n,[{key:"render",value:function e(){var n=this,t=this.state,i=t.text,o=t.errors,s=t.submitting;return y.createElement(z.AuthGated,{call:function e(t){var i=t.csrfToken,a=t.altSessId;return n.submitAnswer({csrfToken:i,altSessionId:a})}},function(e){var t,r;return y.createElement("form",{className:"hotels-community-tab-questions-AnswerForm__upperForm--1RlW5",onSubmit:function n(t){e(),t.preventDefault()}},y.createElement(G.Avatar,{photo:n.props.currentMember?n.props.currentMember.avatar:void 0,display:"inline",target:"_self",href:null===(t=n.props.currentMember)||void 0===t?void 0:null===(r=t.route)||void 0===r?void 0:r.url,withBorder:!0,size:"xtra-small"}),y.createElement("div",{className:"hotels-community-tab-questions-AnswerForm__formContent--2Id-J"},y.createElement(H.TextArea,{value:i,onChange:n.onChange,onFocus:n.onFocus,className:U()("hotels-community-tab-questions-AnswerForm__answerInput--3B4Fn",b()({},"hotels-community-tab-questions-AnswerForm__disabled--HoSOz",s)),placeholder:n.props.topic.postCount?Object(j.localize)("hr_community_qa_answer_question"):Object(j.localize)("hr_community_qa_answer_question_first"),name:"answer",rows:n.state.answering?3:1,disabled:s}),n.state.answering?y.createElement("div",{className:"hotels-community-tab-questions-AnswerForm__underForm--1-YwD"},y.createElement("div",{className:"hotels-community-tab-questions-AnswerForm__guidelines--2Q5er"},y.createElement(z.PostingGuidelinesLink,{location:n.props.location,theme:"community"})),y.createElement("div",null,o&&y.createElement("ul",{className:"hotels-community-tab-questions-AnswerForm__error--cC1dA"},o.map(function(e){return y.createElement("li",{key:e},e)})),y.createElement("div",{className:"hotels-community-tab-questions-AnswerForm__captchas--2o0Qz"},y.createElement(Q.Captchas,null,function(e,t){n.resetCaptcha=t,n.captchaResponse=e})),y.createElement("div",{className:"hotels-community-tab-questions-AnswerForm__ctaButtons--3IeJh"},y.createElement("span",{className:"hotels-community-tab-questions-AnswerForm__ctaWrap--1vg53"},y.createElement(Y.a,{onClick:function n(t){e(),t.preventDefault()},type:"primary",size:"default",disabled:s,loading:s},s?y.createElement(J.LoadingBubbles,{size:"small"}):null,Object(j.localize)("common_Submit"))),y.createElement(Y.a,{onClick:function e(t){t.preventDefault(),s||n.setState(a()({},Z))},type:"secondary",size:"default",disabled:s},Object(j.localize)("btn_cancel"))))):null))})}}]),n}(y.Component),K=function e(n){return y.createElement(z.TranslateModal,n,function(e){return y.createElement("div",{className:"hotels-community-tab-questions-TranslateButton__translate--3uWQp"},y.createElement(Y.a,{onClick:e,type:"secondary",size:"small"},Object(j.localize)("google_translation")))})};K.defaultProps={postingId:void 0};var X=K,ee=t("@ta/styleguide.icon"),ne=t("@ta/overlays.attached-arrow-overlay"),te=t.n(ne),ie=t("@ta/overlays.pieces"),ae=t("@ta/events.window"),oe=t.n(ae),se=function(e){function n(){var e,t;s()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=m()(this,(e=u()(n)).call.apply(e,[this].concat(a))),b()(g()(g()(t)),"state",{numVotes:t.props.numVotes,ajaxMessage:""}),b()(g()(g()(t)),"onVoteResponse",function(e){e.json().then(function(e){void 0!==e.votes&&null!==e.votes?t.setState({numVotes:e.votes,ajaxMessage:e.message}):t.setState({ajaxMessage:e.message})})}),b()(g()(g()(t)),"vote",function(e){var n={altSessionId:t.props.altSessId||"",csrfToken:t.props.securityToken,captchaResponse:{}};e({postingId:t.props.postingId,requestValidation:n,onResponse:t.onVoteResponse})}),t}return k()(n,e),l()(n,[{key:"render",value:function e(){var n=this,t=this.state,i=t.numVotes,a=t.ajaxMessage;return y.createElement("form",{className:"hotels-community-tab-questions-VotingForm__votingForm--19m9f"},y.createElement(z.AuthGated,{call:function e(){return n.vote(z.answersAjax.upVote)}},function(e){return y.createElement("span",{className:"hotels-community-tab-questions-VotingForm__voteButton--3ZDG_",onClick:e},y.createElement(ee.Icon,{name:"thumbs-up-fill"}))}),y.createElement(ie.Target,null,function(e,t){return y.createElement(y.Fragment,null,y.createElement("span",{className:"hotels-community-tab-questions-VotingForm__voteCount--3Jpcv",ref:e},Object(j.localize)("num_votes_plural",{0:i})),t&&a&&y.createElement(te.a,{target:t,position:"above"},y.createElement("div",{className:"hotels-community-tab-questions-VotingForm__ajaxMessage--3N879"},a),y.createElement(oe.a,{event:"click",callback:function e(){return n.setState({ajaxMessage:""})}})))}),y.createElement(z.AuthGated,{call:function e(){return n.vote(z.answersAjax.downVote)}},function(e){return y.createElement("span",{className:"hotels-community-tab-questions-VotingForm__voteButton--3ZDG_",onClick:e},y.createElement(ee.Icon,{name:"thumbs-down-fill"}))}))}}]),n}(y.Component),re=Object(S.connect)(function(e){return{isLoggedIn:e.auth.isMember,securityToken:e.auth.csrfToken,altSessId:e.auth.altSessId}})(se),le=function(e){function n(){var e,t;s()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=m()(this,(e=u()(n)).call.apply(e,[this].concat(a))),b()(g()(g()(t)),"deletePosting",function(){var e=t.props,n=e.posting.id,i=e.csrfToken,a=e.onAnswerDeleted;z.answersAjax.deleteAnswer({id:n,token:i,onResponse:a})}),t}return k()(n,e),l()(n,[{key:"render",value:function e(){var n=this.props,t=n.posting,i=n.currentMember,a=n.locationId;return y.createElement(y.Fragment,null,y.createElement(M.MemberEventOnObjectBlock,{actor:t.userProfile,member:i,objectEventType:"onTopicPosting",object:t,deleteObject:this.deletePosting}),y.createElement("div",{className:"hotels-community-tab-questions-Posting__content--1YUgg"},y.createElement(X,{locationId:a,topicId:t.locationTopicId,postingId:t.id,contentLanguage:t.contentLanguage}),y.createElement(x.DirectionalText,{contentLanguage:t.contentLanguage},t.content),y.createElement(re,{postingId:t.id,numVotes:t.upvotes})))}}]),n}(y.Component),de=Object(S.connect)(function(e){return{csrfToken:e.auth.csrfToken}})(le),me={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"HRComm_PostingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ApiTopicPosting"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"locationTopicId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isOwner"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isReviewer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"upvotes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"contentLanguage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timePublished"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timeSubmitted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"userId"},name:{kind:"Name",value:"id"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"static"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"isMe"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isVerified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isFollowing"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isHorizontal"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"hometown"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fallbackString"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additionalNames"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"long"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"contributionCounts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sumAllUgc"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"helpfulVote"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"route"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:658}};me.loc.source={body:"5f66e490b288"};var ce=me,ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"QuestionSectionPosting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fetchTopic"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fetchPosting"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topicId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"postingId"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"topics"},arguments:[{kind:"Argument",name:{kind:"Name",value:"topicIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"topicId"}}]}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"fetchTopic"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"postings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HRComm_PostingFields"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"postings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"postingIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"postingId"}}]}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"fetchPosting"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HRComm_PostingFields"},directives:[]}]}}]}}],loc:{start:0,end:374}};ue.loc.source={body:"18fa55cfe166"};var ve={};ue.definitions=ue.definitions.concat(function ke(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!ve[n]&&(ve[n]=!0,!0)})}(ce.definitions));var pe=ue,ge=function(e){function n(){var e,t;s()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=m()(this,(e=u()(n)).call.apply(e,[this].concat(a))),b()(g()(g()(t)),"state",{expandAnswers:!1,deletedAnswers:new Set}),b()(g()(g()(t)),"onSeeAllClick",function(e){e.preventDefault(),t.state.expandAnswers||I()({module:"faq",action:"click",context:"show_all_answers"}),t.setState(function(e){return{expandAnswers:!e.expandAnswers}})}),b()(g()(g()(t)),"onAnswerDeleted",function(e){return function(){t.setState(function(n){var t=new Set(n.deletedAnswers);return t.add(e),{deletedAnswers:t}})}}),b()(g()(g()(t)),"deleteTopic",function(){var e=t.props,n=e.topic.id,i=e.csrfToken,a=e.onQuestionDeleted;z.answersAjax.deleteQuestion({id:n,token:i,onResponse:a})}),t}return k()(n,e),l()(n,[{key:"renderToggleLink",value:function e(n){var t=this.props.topic,i=this.state.expandAnswers;return n>1?y.createElement(D.Link,{href:t.url,onClick:this.onSeeAllClick,className:"hotels-community-tab-questions-Topic__seeAllLink--21KIE"},i?Object(j.localize)("hr_community_qa_show_top_answer"):Object(j.localize)("hr_community_qa_show_all_answers")):null}},{key:"renderAnswers",value:function e(){var n=this,t=this.props,i=t.location.locationId,a=t.currentMember,o=t.topic,s=t.topPostingOverride,r=this.state,l=r.expandAnswers,d=r.deletedAnswers;return y.createElement(z.AnswerProvider,{query:pe,topic:o,expanded:l,newPostingId:s},function(e){var t=e.filter(function(e){return!e||!d.has(e.id)}),s=t.length;return t.map(function(e,t){return y.createElement("div",{className:"hotels-community-tab-questions-Topic__content--3wBtU",key:e?e.id:-1*t},e?y.createElement(de,{locationId:i,posting:e,currentMember:a,onAnswerDeleted:n.onAnswerDeleted(e.id)}):y.createElement(P.a,{width:"100%",height:"100px"}),t===s-1?n.renderToggleLink(l?s:o.postCount):null)})})}},{key:"render",value:function e(){var n=this.props,t=n.topic,i=n.currentMember,a=n.location,o=n.onAnswerPosted,s=n.renderFullTopic;return y.createElement(L.Card,{noPadding:!0},y.createElement("div",{className:"hotels-community-tab-questions-Topic__content--3wBtU"},y.createElement(M.MemberEventOnObjectBlock,{actor:t.userProfile,member:i,objectEventType:"onLocationTopic",object:t,deleteObject:this.deleteTopic,renderMemberActions:s}),y.createElement(X,{locationId:a.locationId,topicId:t.id,contentLanguage:t.contentLanguage}),y.createElement(D.Link,{href:t.url,className:"hotels-community-tab-questions-Topic__questionLink--2ACzl"},y.createElement(x.DirectionalText,{contentLanguage:t.contentLanguage},t.content))),this.renderAnswers(),y.createElement(R.HideOnReadonly,null,y.createElement("div",{className:"hotels-community-tab-questions-Topic__content--3wBtU"},y.createElement($,{topic:t,currentMember:i,location:a,onSubmit:o}))))}}]),n}(y.Component);b()(ge,"defaultProps",{csrfToken:""});var fe=Object(S.connect)(function(e){return{csrfToken:e.auth.csrfToken}})(ge),be=t("./packages/hotels/community-tab-common/fragments/MemberFields.fragment.gql"),Ne={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"QuestionsSection"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loggedIn"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loggedInUserId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"currentMember"},name:{kind:"Name",value:"memberProfile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"loggedInUserId"}}}]}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"loggedIn"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MemberFieldsTabFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"geoName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentGeoId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topicCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"locationTopics"},arguments:[{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"ObjectField",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mcid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timeSubmitted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"postCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"contentLanguage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MemberFieldsTabFragment"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"topPosting"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HRComm_PostingFields"},directives:[]}]}}]}}]}}]}}],loc:{start:0,end:795}};Ne.loc.source={body:"80357b386e08"};var he={};function ye(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!he[n]&&(he[n]=!0,!0)})}Ne.definitions=Ne.definitions.concat(ye(be.a.definitions)),Ne.definitions=Ne.definitions.concat(ye(ce.definitions));var Fe=Ne,Se=t("@babel/runtime/helpers/esm/extends"),_e=t.n(Se),we=t("@ta/overlays.headers"),Ee=t("@ta/overlays.managers"),Ie=t("@ta/overlays.modal"),Te=t("@ta/hotels.community-content-common"),Ae=function(e){function n(){var e,t;s()(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t=m()(this,(e=u()(n)).call.apply(e,[this].concat(o))),b()(g()(g()(t)),"state",{text:"",errors:null,submitting:!1}),b()(g()(g()(t)),"onChange",function(e){return t.setState({text:e.currentTarget.value})}),b()(g()(g()(t)),"onSubmitResponse",function(e){t.setState({submitting:!1}),e.ok?t.props.onSubmit(e):e.json().then(function(e){t.resetCaptcha(),t.setState({errors:e.errors})})}),b()(g()(g()(t)),"submitQuestion",function(e){if(t.state.text){t.setState({submitting:!0});var n=t.props.location.locationId,i=t.state.text,o=a()({},e,{captchaResponse:t.captchaResponse});z.answersAjax.submitQuestion({locationId:n,text:i,requestValidation:o,onResponse:t.onSubmitResponse})}}),b()(g()(g()(t)),"captchaResponse",{}),b()(g()(g()(t)),"resetCaptcha",function(){}),t}return k()(n,e),l()(n,[{key:"render",value:function e(){var n=this,t=this.props,i=t.location.name,a=t.onCancel,o=this.state,s=o.text,r=o.errors,l=o.submitting;return y.createElement(y.Fragment,null,y.createElement("div",{className:"ui_header h3"},Object(j.localize)("qa_get_quick_answers_56a",{0:i})),y.createElement(z.AuthGated,{call:function e(t){var i=t.csrfToken,a=t.altSessId;return n.submitQuestion({csrfToken:i,altSessionId:a})}},function(e){var t,i;return y.createElement("form",{className:"hotels-community-tab-questions-QuestionsForm__upperForm--3eo5C",onSubmit:function n(t){e(),t.preventDefault()}},y.createElement(G.Avatar,{photo:n.props.currentMember?n.props.currentMember.avatar:void 0,display:"inline",target:"_self",href:null===(t=n.props.currentMember)||void 0===t?void 0:null===(i=t.route)||void 0===i?void 0:i.url,withBorder:!0,size:"xtra-small"}),y.createElement("div",{className:"hotels-community-tab-questions-QuestionsForm__formContent--3UTEQ"},y.createElement(H.TextArea,{value:s,onChange:n.onChange,className:U()("hotels-community-tab-questions-QuestionsForm__answerInput--2CiFw",b()({},"hotels-community-tab-questions-QuestionsForm__disabled--COHUC",l)),placeholder:Object(j.localize)("qa_q_placeholder_lo"),name:"answer",rows:6,disabled:l}),r&&y.createElement("ul",{className:"hotels-community-tab-questions-QuestionsForm__error--1e0jY"},r.map(function(e){return y.createElement("li",{key:e},e)})),Object(j.localize)("qa_question_overlay_note_56a"),y.createElement("div",{className:"hotels-community-tab-questions-QuestionsForm__guidelines--37spU"},y.createElement(z.PostingGuidelinesLink,{location:n.props.location,theme:"community",inlineExpansion:!0})),y.createElement("div",{className:"hotels-community-tab-questions-QuestionsForm__captchas--1cAHf"},y.createElement(Q.Captchas,null,function(e,t){n.resetCaptcha=t,n.captchaResponse=e})),y.createElement("div",{className:"hotels-community-tab-questions-QuestionsForm__ctaButtons--W6MYH"},y.createElement("span",{className:"hotels-community-tab-questions-QuestionsForm__ctaWrap--3wL1R"},y.createElement(Y.a,{onClick:function n(t){e(),t.preventDefault()},type:"primary",size:"default",disabled:l,loading:l},l?y.createElement(J.LoadingBubbles,{size:"small"}):null,Object(j.localize)("common_Submit"))),y.createElement(Y.a,{onClick:function e(n){n.preventDefault(),a()},type:"secondary",size:"default",disabled:l},Object(j.localize)("btn_cancel")))))}))}}]),n}(y.Component),qe=function e(n){return y.createElement(Ie.Modal,{name:Te.QUESTION_FORM_MODAL_NAME,header:y.createElement(we.TitleBar,{iconName:"forums",displayType:"LEFT_ALIGN_GRAY"},Object(j.localize)("hr_ask_a_question"))},y.createElement(Ee.Closer,null,function(e){return y.createElement("div",{className:"hotels-community-tab-questions-QuestionFormModal__container--2yO2D"},y.createElement(Ae,_e()({},n,{onCancel:e,onSubmit:function t(i){e(),n.onSubmit(i)}})))}))},Ce=function(e){function n(){var e,t;s()(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=m()(this,(e=u()(n)).call.apply(e,[this].concat(a))),b()(g()(g()(t)),"state",{topPostingOverrides:new Map,deletedTopics:new Set}),b()(g()(g()(t)),"previousTopicCount",0),t}return k()(n,e),l()(n,[{key:"shouldComponentUpdate",value:function e(n){return n.isSelectedTab}},{key:"render",value:function e(){var n=this,t=this.props,i=t.locationId,o=t.loggedInUserId,s={locationId:i,limit:5,loggedInUserId:o,loggedIn:!!o};return y.createElement(q.HasBeenVisible,{onVisible:function e(){I()({module:"faq",action:"in_view",context:""})}},function(e){return y.createElement("div",{ref:e,"data-test-target":"questions-tab"},y.createElement(_.PaginationStateController,null,function(e){var t=e.offset,o=e.changePageOffset,r=!i||i<0;return y.createElement(F.Query,{query:Fe,variables:a()({offset:t},s),skip:r,errorPolicy:"all"},function(e){var i=e.data,l=e.loading,d=e.refetch,m=r||l,c=function u(e,n){if(e||!(n&&n.locations&&n.locations[0]))return{location:{locationId:-1,name:"",geoName:"",parentGeoId:-1},topicCount:0,locationTopics:[],currentMember:void 0};var t=n.currentMember,i=n.locations;i=void 0===i?[]:i;var a=h()(i,1)[0],o=(a=void 0===a?{}:a).topicCount,s=a.locationTopics,r=void 0===s?[]:s;return{location:{locationId:a.locationId,name:a.name,geoName:a.geoName,parentGeoId:a.parentGeoId},topicCount:o,locationTopics:r,currentMember:t}}(m,i),v=c.topicCount,k=c.locationTopics,p=c.currentMember,g=c.location;m||(n.previousTopicCount=v);var f=function e(){o({offset:0}),d(a()({offset:0},s)).then(function(){return V()("hr-community-tab").emit("selectTab","Questions",!0)})},b=function e(t){return function(){n.setState(function(e){var n=new Set(e.deletedTopics);return n.add(t),{deletedTopics:n}},d)}},N=function e(t){return function(e){e.json().then(function(e){return n.setState(function(n){var i=new Map(n.topPostingOverrides);return i.set(t,e.postingId),{topPostingOverrides:i}},d)})}};return m||v?y.createElement(y.Fragment,null,m?y.createElement(w.FeedLoadingSkeleton,{numSections:5}):k.filter(function(e){return!n.state.deletedTopics.has(e.id)}).map(function(e){return y.createElement(fe,{topic:a()({},e,{location:g}),location:g,key:e.id,currentMember:p,topPostingOverride:n.state.topPostingOverrides.get(e.id),onAnswerPosted:N(e.id),onQuestionDeleted:b(e.id),renderFullTopic:n.props.isSelectedTab})}),y.createElement(A.a,{offset:t,limit:5,total:v||n.previousTopicCount,module:"faq",onClick:function e(n){return o(n)}}),y.createElement(qe,{currentMember:p,location:g,onSubmit:f})):y.createElement(qe,{currentMember:p,location:g,onSubmit:f})})}))})}}]),n}(y.Component);n.default=Object(S.connect)(function(e){return{locationId:e.page.detailId,geoId:e.page.geoId,loggedInUserId:e.auth.loggedInUserId}})(Ce)}}});
//# sourceMappingURL=hotels.community-tab-questions.9b4fadb1e9.js.map