
<!-- saved from url=(3181)https://www.jscache.com/static/page_moniker/facebook_dat-v23907567945a.html#pixelType=PAGEVIEW&curLocId=1076311&geoId=3176298&locPrices=6222&tadomain=tripadvisor.co.za&reqUnique=3356a2a16b3199d74321b7614c8c27a84230024e&userUnique=14091f2009b140696f3daab96188dc3c7cd8821b&fbUserUnique=de0523c456c7e4528b09621cd02108df2333ed95993404e1ede8a47714bd3bf2&locale=en_ZA&countryID=293740&ipCountryAbbrev=ZA&seqId=11&sessionId=87AA25E980CD06B8851DA426BA54DBE7&currency=ZAR&timestampIn=1561262400&timestampOut=1561348800&numNights=1&numRooms=1&roomNights=1&numAdults=2&numChildren=0&timezone=AST&regionName=&cityName=Bavaro&stateOrCityName=Bavaro&countryName=Caribbean&countryAbbrev=VI&destinationName=Hard%20Rock%20Hotel%20&%20Casino%20Punta%20Cana&locationType=Accommodation&nearestAirport=PUJ&propId=1076311&propName=Hard%20Rock%20Hotel%20&%20Casino%20Punta%20Cana&brandName=Hard%20Rock%20Hotels&recPercent=82&stDest=Bavaro%2CDominican+Republic&geoName=Bavaro&geoParentId=147293&geoParentName=Punta%20Cana&locPrice1=6222&loc1=1076311&productIds=[%22%22,%22d1076311enZA%22,%223176298enZA%22]&productIdsShort=,d1076311enZA,3176298enZA&device=Desktop&fbDevice=1&device2=desktop&userGeo=312583&siteType=d&trueServlet=Hotel_Review&genTrueServlet=Hotel_Review&fbTrueServlet=H&fbRetargetingType=1&servlet=Hotel_Review&geoFeedBucket=all&serverName=www.tripadvisor.co.za&puid=XQOcYAokH5QAAKzTPEYAAACD&isMobileDevice=n&rtPath=www.tamgrt.com/RT&random=3344221232&taSplit=2&mcid=13091&fbChannel=-1&isOrganic=false&criteoDedup=0&tasource=OTH&geo=3176298&isClickoutYN=no&isLoggedIn=N&securelyLoggedIn=N&stuid=NY1QkB0y0N5od8wyqM9_4KBbv7tQih4HZPttMs6n5NMMT0UIuj4KbyTwcfNn-NTk&countryAlpha2=ZA&criteoPartnerId=20914&criteoAttractionPartnerId=30224&criteoHotelAcct=%5Ban%3Dweb-hotels-tripadvisor.com%26cn%3Dza%26ln%3Den%2Can%3Dweb-hotels-0-tripadvisor.com%26cn%3Dza%26ln%3Den%2Can%3Dweb-hotels-1-tripadvisor.com%26cn%3Dza%26ln%3Den%2Can%3Dweb-hotels-2-tripadvisor.com%26cn%3Dza%26ln%3Den%5D&flight_originid=&flight_destid=&flight_startdate=2019-06-28&flight_enddate=2019-07-05&dynx_itemid=null_null_20190628_20190705&flight_num_tix=1&numSeniors=0&attractionShoppingCartTotalPriceUSD=0.00&facebookuvm_v2UlbScore=0.37042892926446735&facebookuvm_v2UlbBucket=18&fbUlbMultiplier=0.1784565489643128&facebookUlbScore=0.4245311846492&facebookUlbBucket=100&googleExperimentSegment=test&googleUlbScore=0.206999863&googleUlbBucket=1&googleuvm_v2UlbBucket=2&googleuvm_v2UlbScore=0.13564885000000002&UVMBESTSCORE=0.08&UVMSCOPE=UVM_V2&UVMSAVEABLE=0&googleuvm_v2.1UlbBucket=2&googleuvm_v2.1UlbScore=0.07596969842256002&googleuvm_v2.1UlbBucketParamName=uvm_display_desktop_bucket&googleuvm_complexUlbBucket=1&googleuvm_complexUlbScore=0.029734104871749878&criteoUlbScore=0.07596969842256002&criteoUlbBucket=2&criteoUlbScoreCurrent=0.07596969842256002&criteoUlbBucketCurrent=2&DBISCORE=0.03168509820374406&DBIFLAG=true&mofSlice=8&mofLastUpdated=20190614&refHost=za.pinterest.com&smarterTravelPixelID=gqLWKHSnTxes4YmmtgWkqA&smarterTravelPixelDomain=p.smartertravel.com&isSTConversion=false&googleCRMId=bd682b33612b336d5f65cef0c6e834c550e99256&rexSplit=c&NanigansTestSegment=0&is_default_dates=Yes&pixelName=facebook_dat_pixel -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
  </head>
  <body>
    <script src="./inferredEvents.js.download" async=""></script><script src="./666624680067334" async=""></script><script async="" src="./fbevents.js.download"></script><script type="text/javascript">
      // Pull params from URL (argdict maps keys to values or arrays of values)
      var argdict = {};
      var args = window.location.hash.substring(1).split("&");
      for (var i = 0; i < args.length; i++) {
        var pair = args[i].split("=");

        if (typeof argdict[pair[0]] === "undefined") {
          argdict[pair[0]] = pair[1];
        } else if (typeof argdict[pair[0]] === "string") {
          argdict[pair[0]] = [argdict[pair[0]], pair[1]];
        } else {
          argdict[pair[0]].push(pair[1]);
        }
      }

      var fbPixelName = 'ViewContent'
          , fbContentType = '["hotel","destination"]';
      if (argdict.pixelType === 'CLICKOUT') {
        fbPixelName = 'InitiateCheckout';
      } else if (argdict.trueServlet === 'Tourism' || argdict.trueServlet === 'MobileTourism') {
        fbPixelName = 'Search';
      } else if (argdict.pixelType === 'ENTER_DATES') {
        fbPixelName = 'EnterDates'
      }

      var applicationId = encodeURIComponent(250701451714610);      
      // event name for Dynamic Product Ads
      var eventName = encodeURIComponent(fbPixelName);
      var fbCategory = encodeURIComponent(argdict.fbTrueServlet);
      var fbDevice = encodeURIComponent(argdict.fbDevice);
      var fbDateIn = encodeURIComponent(argdict.fbDateIn);
      var fbDateOut = encodeURIComponent(argdict.fbDateOut);
      var geoId = encodeURIComponent(argdict.geoId);
      // if no property id, returns the geo's most popular property id if there is one
      var PropId = encodeURIComponent(argdict.propId ? argdict.propId : argdict.geoMostPop);
      var mcid = encodeURIComponent(argdict.mcid);
      var countryID = encodeURIComponent(argdict.countryID);
      var fbUserUnique = encodeURIComponent(argdict.fbUserUnique);
      var userUnique = encodeURIComponent(argdict.userUnique);
      var ulbBucket = encodeURIComponent(argdict.facebookUlbBucket);
      var ulbScore = encodeURIComponent(argdict.facebookUlbScore);
      var fbRegion = encodeURIComponent(argdict.regionName);
      var fbCity = encodeURIComponent(argdict.cityName);
      var fbCountry = encodeURIComponent(argdict.countryAbbrev);
      var fbDestinationName = encodeURIComponent(argdict.destinationName);
      var fbLocationType = encodeURIComponent(argdict.locationType);
      var fbRetargetingType = encodeURIComponent(argdict.fbRetargetingType);
      var fbUlbMultiplier = encodeURIComponent(argdict.fbUlbMultiplier);

      // Only one model will be calculated for each user - v2, v2.1, or complex
      var uvmV2Bucket;
      var uvmV2Score;
      if (argdict.hasOwnProperty('facebookuvm_complexUlbBucket') && argdict.hasOwnProperty('facebookuvm_complexUlbScore')) {
        uvmV2Bucket = argdict.facebookuvm_complexUlbBucket;
        uvmV2Score = argdict.facebookuvm_complexUlbScore;
      }
      else if (argdict.hasOwnProperty('facebookuvm_v2.1UlbBucket') && argdict.hasOwnProperty('facebookuvm_v2.1UlbScore')) {
        uvmV2Bucket = argdict['facebookuvm_v2.1UlbBucket'];
        uvmV2Score = argdict['facebookuvm_v2.1UlbScore'];
      }
      else {
        uvmV2Bucket = argdict.facebookuvm_v2UlbBucket;
        uvmV2Score = argdict.facebookuvm_v2UlbScore;
      }
      uvmV2Bucket = encodeURIComponent(uvmV2Bucket);
      uvmV2Score = encodeURIComponent(uvmV2Score);

      var dateIn;
      var dateOut;
      if (argdict.timezone !== undefined)
      {
        // Send checkin and checkout dates with time of midnight (actually 11:59pm to keep the date the same) and timezone of the hotel
        dateIn = argdict.dateIn + 'T23:59:59' + argdict.timezone;
        dateOut = argdict.dateOut + 'T23:59:59' + argdict.timezone;
      }
      else
      {
        dateIn = argdict.dateIn;
        dateOut = argdict.dateOut;
      }

      // product ids for Dynamic Product Ads. Currently returning a property product followed by a geo product to ensure the geo product is the last product fired
      var productIds = [];
      if (typeof argdict['loc1'] !== 'undefined') {
        // On Hotels page, loc1 is the top commerce hotel for the geo in the POS.
        // On properties page, loc1 is the actual hotel.
        // In all other pages(e.g. SmartDeals page), loc1 is the top pop hotel of the geo.
        productIds.push(encodeURIComponent('d' + argdict['loc1'] + argdict.locale.replace('_', '')));
      }
      productIds.push(encodeURIComponent(geoId + argdict.locale.replace('_' , '')));
      
      // The following code, except the hashed email logic, is copy pasted from facebook.
      !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
      n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
      document,'script','//connect.facebook.net/en_US/fbevents.js');
      
      // Note: Using a variable for the pixel id instead of passing it directly causes FB's pixel helper chrome plug-in to break
      if (typeof argdict['fbHEml'] !== 'undefined') {
        fbq('init', '666624680067334', {em: encodeURIComponent(argdict.fbHEml)});
      }
      else {
        fbq('init', '666624680067334');
      }

      //End of copy paste from facebook.

      // For obfuscated pixel key mapping, see FB_PIXEL_KEY_MAPPING in PageMoniker.java
      // These are used for Facebook DPA ad creation, do not modify without consulting vwang@ or om-fb@
      var params = {
        'application_id' : applicationId,
        'content_type' : fbContentType,
        'content_ids' : productIds,
        'region' : fbRegion,
        'city' : fbCity,
        'country' : fbCountry,
        'destination' : fbDestinationName,
        'types' : fbLocationType,
        'external_id': fbUserUnique,
        'FB1' : fbDateIn,           // fbCheckInDate
        'FB2' : fbDateOut,          // fbCheckOutDate
        'FB3' : geoId,              // destinationCode
        'FB4' : fbDevice,           // fbDevice
        'FB5' : countryID,          // IP country id
        'FB7' : mcid,               // mcid
        'FB8' : fbCategory,         // fbProductType
        'FB9' : PropId,             // propertyID
        'FB10': userUnique,         // userUnique - this is passed so Facebook can match users with data we provided in an offline file (5/13/15)
        'FB13': ulbBucket,          // User level bid bucket (UVM v1)
        'FB14': ulbScore,           // User level bid score (UVM v1)
        'FB17': fbRetargetingType,  // Retargeting type
        'FB18': fbUlbMultiplier,    // User level bid multiplier
        'FB27': uvmV2Bucket,        // ULB bucket for v2 (for testing)
        'FB28': uvmV2Score,         // ULB score for v2 (for testing)
        'user_bucket': uvmV2Bucket  // Parameter for FB's new ULB product 
      };
      if (fbPixelName === 'InitiateCheckout') {
        // Use puid as conversion unique
        params.order_id = argdict.puid;
        params.deferred_id = userUnique;
        params.value = argdict.fbBrpc;
        params.currency = 'USD';
      }

      params.checkin_date = dateIn;
      params.checkout_date = dateOut;

      // for Dynamic Product Ads
      if (fbPixelName === 'EnterDates') {
        fbq('trackCustom', eventName, params);
      } else if (fbPixelName === 'InitiateCheckout') {
        // Event id is used to deduplicate with S2S events (must match "event_id" set in FBWebEventApiRequestGenerator)
        fbq('trackSingle', '666624680067334', eventName, params, {eventID: argdict.puid + fbPixelName});
      } else {
        fbq('track', eventName, params);
      }
    </script>
  

</body></html>