(window.$WP=window.$WP||[]).push({id:"@ta/social.onboarding-controller",d:["vendor-babel","vendor-react-libs","vendor-apollo-libs","ta-platform","@ta/common.localstorage","@ta/social.educational-tooltips","@ta/social.onboarding-state","@ta/social.onboarding-utils","@ta/common.client","ta-common","@ta/tracking.interactions","@ta/overlays.modal","@ta/overlays.managers","@ta/social.suggested-followees"],e:["./packages/social/onboarding-controller/OnboardingController.jsx"],x:{"./packages/social/feed/feedFragments/HometownFields.fragment.gql":["a"],"./packages/social/onboarding-controller/OnboardingController.jsx":["OnboardingController","default"]},m:{"./packages/social/feed/feedFragments/HometownFields.fragment.gql":function(e,n,t){"use strict";var o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"HometownFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MemberLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fallbackString"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"location"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additionalNames"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"long"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locationId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:203}};o.loc.source={body:"cd3d893a1d20"},n.a=o},"./packages/social/onboarding-controller/OnboardingController.jsx":function(e,n,t){"use strict";t.r(n);var o=t("@babel/runtime/helpers/esm/classCallCheck"),a=t.n(o),i=t("@babel/runtime/helpers/esm/createClass"),r=t.n(i),s=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),l=t.n(s),d=t("@babel/runtime/helpers/esm/getPrototypeOf"),c=t.n(d),u=t("@babel/runtime/helpers/esm/inherits"),m=t.n(u),g=t("@babel/runtime/helpers/esm/assertThisInitialized"),p=t.n(g),f=t("@babel/runtime/helpers/esm/defineProperty"),b=t.n(f),h=t("react"),v=t("react-apollo"),O=t("@ta/common.api"),k=t("@ta/common.tracking"),C=t.n(k),S=t("@ta/common.localstorage"),_=t.n(S),w=t("@ta/events.window-scroll"),F=t.n(w),E=t("@ta/common.features"),N=t("@ta/social.educational-tooltips"),I=t("@ta/social.onboarding-state"),A=t("@ta/social.onboarding-utils"),y=t("react-redux"),T=t("@ta/common.client"),L=t("@ta/common.logging"),M=t.n(L),R=t("@ta/styleguide.loading"),P=t("@ta/platform.import"),D=t("@ta/tracking.interactions"),H=t("@ta/social.suggested-followees"),U=t("@ta/overlays.managers"),G=Object(P.deferredImport)("@ta/social.confirm-username","ConfirmUsername"),j=Object(P.deferredImport)("@ta/social.onboarding","SplashScreen"),B=Object(P.deferredImport)("@ta/social.onboarding","FullscreenSplash"),x=Object(P.deferredImport)("@ta/social.onboarding","ChooseHometown"),W=Object(P.deferredImport)("@ta/social.onboarding","SuggestedFollows"),K=Object(P.deferredImport)("@ta/social.onboarding","FacebookConnect"),V=Object(P.deferredImport)("@ta/social.onboarding","SuggestedFacebookFollows"),q=Object(P.deferredImport)("@ta/social.onboarding","AllSet"),Q=function e(n){var t=n.userData,o=n.facebookConnected,a=n.card,i=n.onCardComplete,r=n.onSkip,s=n.trackingModule,l=n.openRegOverlay,d=n.endFlow,c=n.isLoggedIn,u=n.userMadeChanges,m=n.isInitialScreen;switch(a){case ee:return h.createElement(j,{onComplete:c?i:l,trackingModule:s});case ne:return h.createElement(U.Closer,null,function(e){return h.createElement(B,{onComplete:c?i:l,trackingModule:s,onDismiss:function n(){d(e)}})});case te:return h.createElement(U.Closer,null,function(e){return h.createElement(G,{onComplete:i,trackingModule:s,closerForError:function n(){d(e)}})});case oe:var g=t&&t.hometown&&t.hometown.location&&t.hometown.location.additionalNames&&t.hometown.location.additionalNames.long;return h.createElement(x,{onComplete:i,currentHometown:g,trackingModule:s});case ae:return h.createElement(D.FollowTabTypeContext.Provider,{value:{tabType:"SUGGESTED_FOR_YOU"}},h.createElement(W,{onComplete:i,trackingModule:s,isInitialScreen:m}));case re:return h.createElement(D.FollowTabTypeContext.Provider,{value:{tabType:"FACEBOOK_FRIENDS"}},h.createElement(K,{onComplete:i,onSkip:r,facebookConnected:o,trackingModule:s}));case ie:return h.createElement(H.ValidatedFacebookToken,{callback:i,trackingModule:s,isOnboarding:!0},h.createElement(V,{onComplete:i,trackingModule:s}));case se:return h.createElement(U.Closer,null,function(e){return h.createElement(q,{photo:t.avatar,displayName:t.displayName,onComplete:function n(){d(e)},trackingModule:s,userHasInteracted:u})});default:return M.a.error("OnboardingModal: No case provided for current screen type: ".concat(a)),d(),null}},X=t("@ta/common.classnames"),Y=t.n(X),z=t("@ta/overlays.modal"),$={onboardingContainer:"social-onboarding-controller-ModalContainer__onboardingContainer--32952",namescreen:"social-onboarding-controller-ModalContainer__namescreen--1-QRb",hometownscreen:"social-onboarding-controller-ModalContainer__hometownscreen--akQdw",facebookconnectscreen:"social-onboarding-controller-ModalContainer__facebookconnectscreen--1ksut",Allsetscreen:"social-onboarding-controller-ModalContainer__Allsetscreen--11REF",followscreen_brand:"social-onboarding-controller-ModalContainer__followscreen_brand--16qZQ",followscreen_facebook:"social-onboarding-controller-ModalContainer__followscreen_facebook--39tYa",placeholder:"social-onboarding-controller-ModalContainer__placeholder--17k3L",valuepropscreen:"social-onboarding-controller-ModalContainer__valuepropscreen--2FABO",fullscreensplash:"social-onboarding-controller-ModalContainer__fullscreensplash--1pQE-"},Z=function e(n){var t=n.onCloseAttempt,o=n.disableFullscreenOnMobile,a=n.fullscreenAlways,i=n.allowsClose,r=n.closeXColor,s=n.card,l=n.children,d={name:"onboarding-interstitial",isFullBleed:!0,fullscreenAlways:a,onClose:t,disableFullscreenOnMobile:o,closeXColorVariant:r,closeX:i};return h.createElement(h.Fragment,null,h.createElement(U.Opener,{name:"onboarding-interstitial"},function(e){return e(),null}),h.createElement(z.Modal,d,h.createElement("div",{className:Y()($.onboardingContainer,$[s])},l)))};Z.defaultProps={allowsClose:!1,disableFullscreenOnMobile:!1,fullscreenAlways:!1,onCloseAttempt:function e(){},closeXColor:void 0};var J=Z,ee="valuepropscreen",ne="fullscreensplash",te="namescreen",oe="hometownscreen",ae="followscreen_brand",ie="followscreen_facebook",re="facebookconnectscreen",se="Allsetscreen",le=[ee,te,oe,ae,re,ie,se],de=[te,oe,ae,re,ie,se],ce=[ae,re,ie,se],ue=[te],me={UNKNOWN:"Social_onboarding_unknown",DEFAULT:"Social_onboarding_default",FULLSCREEN_SPLASH:"Social_onboarding_fullscreen_splash",BRAND_EDUCATOR:"Social_onboarding_brandedu",MASTHEAD:"Social_onboarding_masthead",FOLLOW_ACTION:"Social_onboarding_follow_action",LIKE_ACTION:"Social_onboarding_like_action",REPOST_ACTION:"Social_onboarding_repost_action",SAVE_ACTION:"Social_onboarding_save_action",GOOGLE_ONETAP:"Social_onboarding_googleonetap",GOOGLE_ONETAP_NON_HOME:"Social_onboarding_googleonetap_non_home",TA_TWOTAP:"Social_onboarding_tatwotap",TA_TWOTAP_NON_HOME:"Social_onboarding_tatwotap_non_home",FACEBOOK_ENGAGEMENT_CARD:"Social_onboarding_fb_engagement_card"},ge={UNKNOWN:le,DEFAULT:le,FULLSCREEN_SPLASH:[ne,te,oe,ae,re,ie,se],REGISTRATION_SPLASH:["regsplash",te,oe,ae,re,ie,se],BRAND_EDUCATOR:de,MASTHEAD:de,FOLLOW_ACTION:ce,LIKE_ACTION:ce,REPOST_ACTION:ce,SAVE_ACTION:ce,GOOGLE_ONETAP:de,GOOGLE_ONETAP_NON_HOME:ue,TA_TWOTAP:de,TA_TWOTAP_NON_HOME:ue,FACEBOOK_ENGAGEMENT_CARD:[te,ie,se]},pe=Object(P.deferredImport)("@ta/social.onboarding","SplashScreen"),fe=Object(P.deferredImport)("@ta/social.onboarding","FullscreenSplash"),be=Object(P.deferredImport)("@ta/social.onboarding","RegistrationSplash"),he=!0,ve=function(e){function n(e){var t;return a()(this,n),t=l()(this,c()(n).call(this,e)),b()(p()(p()(t)),"onCloseAttempt",function(){t.screenAllowsClose()&&(C()({module:me[t.props.firedFrom],action:"".concat(t.state.flow[t.state.screen],"_close"),context:t.userIsLoggedIn()?"logged_in":"logged_out"}),t.disableModal(),t.props.onClose&&t.props.onClose())}),b()(p()(p()(t)),"onRegOverlayComplete",function(e){if(t.userIsLoggedIn()){he=!0,t.incrementFlow(!1);var n=e&&(e.hasCreatedMember||!e.hasAcceptedTermsOfUse);t.state.showLoading!==n&&t.setState({showLoading:n})}}),b()(p()(p()(t)),"onRegOverlayClose",function(e){void 0!==e.trigger?(t.disableModal(),t.props.onClose&&t.props.onClose()):t.state.waiting&&t.setState({waiting:!1})}),b()(p()(p()(t)),"openRegOverlay",function(e){t.state.waiting||t.setState({waiting:!0}),window.require(["ta/registration/RegOverlay"],function(n){var o="MOBILE"===t.props.viewportCategory,a=e?"login":"join";n.showRegOverlay(null,null,o,{flow:"CORE_COMBINED",pid:Object(A.isHomePageMemberGateTest)()?40552:40463,userRequestedForce:"true",extraQueryParams:{social:"true",flowOrigin:a},onSuccess:function e(n){t.onRegOverlayComplete(n)},onClose:function e(n){t.onRegOverlayClose(n)}})})}),b()(p()(p()(t)),"userIsLoggedIn",function(){return null!==t.props.loggedInUserId}),b()(p()(p()(t)),"screenAllowsClose",function(){switch(ge[t.props.firedFrom]){case le:return t.state.flow[t.state.screen]===ee;case ce:return t.state.flow[t.state.screen]===ae||t.state.flow[t.state.screen]===se&&"Home"!==t.props.servlet;case de:return t.state.flow[t.state.screen]===se&&"Home"!==t.props.servlet;default:return!1}}),b()(p()(p()(t)),"increment",function(){t.setState({screen:t.state.screen+1},function(){t.setUpCurrentFlow()})}),b()(p()(p()(t)),"incrementTwice",function(){t.setState({screen:t.state.screen+2},function(){t.setUpCurrentFlow()})}),b()(p()(p()(t)),"incrementFlow",function(e){e&&!t.state.userMadeChanges&&t.setState({userMadeChanges:!0}),t.increment()}),b()(p()(p()(t)),"endFlow",function(e){t.disableModal(),e&&e(),t.props.onFlowEnd&&t.props.onFlowEnd(t.state.userMadeChanges)}),b()(p()(p()(t)),"disableModal",function(){t.state.disabled||t.setState({disabled:!0})}),b()(p()(p()(t)),"seenOnboarding",function(e){if(he=!1,null===e)return!1;switch(t.props.firedFrom){case"DEFAULT":case"UNKNOWN":return t.userIsLoggedIn()?e.states.find(function(e){return"ONBOARDING_CONFIRM_USER"===e.id&&"COMPLETED"===e.state}):e.states.find(function(e){return"ONBOARDING_SPLASH"===e.id});case"FULLSCREEN_SPLASH":case"REGISTRATION_SPLASH":case"MASTHEAD":case"BRAND_EDUCATOR":case"GOOGLE_ONETAP":case"GOOGLE_ONETAP_NON_HOME":case"TA_TWOTAP":case"TA_TWOTAP_NON_HOME":return e.states.find(function(e){return"ONBOARDING_CONFIRM_USER"===e.id&&"COMPLETED"===e.state});case"FOLLOW_ACTION":case"LIKE_ACTION":case"REPOST_ACTION":case"SAVE_ACTION":return e.states.find(function(e){return"ONBOARDING_FOLLOW"===e.id});case"FACEBOOK_ENGAGEMENT_CARD":return!1;default:return M.a.error("Unexpected flow state in onboarding, this should never happen."),!0}}),b()(p()(p()(t)),"shouldSuppressBasedOnInsightData",function(){var e=t.props.data,n=e&&e.insightProfile;if(!n)return!1;var o=n.uiCardsState;return he&&t.seenOnboarding(o)}),t.state={disabled:e.readOnly,waiting:!1,showLoading:e.immediateLoad,screen:0,userMadeChanges:!1,flow:ge[e.firedFrom]},he=!0,t}return m()(n,e),r()(n,[{key:"componentDidMount",value:function e(){Object(E.featureIsEnabled)("suggested_facebook_connections")||this.setState({flow:this.state.flow.filter(function(e){return e!==ie})}),this.setUpCurrentFlow()}},{key:"shouldComponentUpdate",value:function e(n){return this.props.firedFrom!==n.firedFrom&&(this.setState({disabled:!1,waiting:!1,showLoading:n.immediateLoad,screen:0,userMadeChanges:!1,flow:ge[n.firedFrom]}),he=!0),!0}},{key:"setUpCurrentFlow",value:function e(){this.state.screen>=this.state.flow.length&&this.endFlow()}},{key:"render",value:function e(){if(this.state.disabled||this.state.waiting||this.props.readOnly)return null;var n=this.props,t=n.loading,o=n.data,a=n.firedFrom;if(t)return this.state.showLoading?h.createElement(J,{card:"placeholder"},h.createElement(R.LoadingSpinner,null)):null;if(this.userIsLoggedIn()&&(!o||!o.memberProfiles||!o.memberProfiles[0]))return null;var i=o&&o.memberProfiles&&o.memberProfiles[0],r=o&&o.myExternallyConnectedAccountTypes&&o.myExternallyConnectedAccountTypes.includes("FACEBOOK"),s=this.state.flow[this.state.screen]===se,l=this.state.flow[this.state.screen]===ne&&"MOBILE"!==this.props.viewportCategory,d=this.state.flow[this.state.screen]===ee||this.state.flow[this.state.screen]===se?"WHITE":void 0,c=0===this.state.screen;if(this.shouldSuppressBasedOnInsightData())return C()({module:me[a],action:"".concat(this.state.flow[this.state.screen],"_notshown"),context:this.userIsLoggedIn()?"logged_in":"logged_out"}),this.disableModal(),this.props.onDisable&&this.props.onDisable(),null;if((this.state.flow[this.state.screen]===ne||"regsplash"===this.state.flow[this.state.screen])&&Object(A.wasSoftGateShownRecently)())return null;if("Home"===this.props.servlet&&"MOBILE"!==this.props.viewportCategory&&"regsplash"===this.state.flow[this.state.screen])return h.createElement(be,{onRegOverlayComplete:this.onRegOverlayComplete,onRegOverlayClose:this.onRegOverlayClose});if("Home"===this.props.servlet&&"MOBILE"===this.props.viewportCategory){if(this.state.flow[this.state.screen]===ee)return h.createElement(pe,{onComplete:this.userIsLoggedIn()?this.incrementFlow:this.openRegOverlay,trackingModule:me[a]});if(this.state.flow[this.state.screen]===ne)return h.createElement(fe,{onComplete:this.openRegOverlay})}return h.createElement(T.ClientOnly,null,h.createElement(D.TrackingNamespaceContext.Provider,{value:"onboarding"},h.createElement(D.OnboardingTrackingContext.Provider,{value:{userId:this.props.loggedInUserId,uid:this.props.uid}},h.createElement(J,{onCloseAttempt:this.onCloseAttempt,disableFullscreenOnMobile:s,fullscreenAlways:l,allowsClose:this.screenAllowsClose(),closeXColor:d,card:this.state.flow[this.state.screen]},h.createElement(Q,{card:this.state.flow[this.state.screen],userData:i,facebookConnected:r,isLoggedIn:this.userIsLoggedIn(),onCardComplete:this.incrementFlow,openRegOverlay:this.openRegOverlay,isInitialScreen:c,endFlow:this.endFlow,trackingModule:me[a],userMadeChanges:this.state.userMadeChanges,onSkip:this.incrementTwice})))))}}]),n}(h.Component);b()(ve,"defaultProps",{onClose:void 0,onFlowEnd:void 0,onDisable:void 0});var Oe=Object(y.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId,viewportCategory:e.meta.device.viewportCategory,uid:e.tracking.uid,readOnly:e.meta.readonlyMode,servlet:e.meta.initialServletName}})(ve),ke=t("./packages/social/feed/feedFragments/HometownFields.fragment.gql"),Ce={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"OnboardingProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loggedIn"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"memberProfiles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userIds"},value:{kind:"ListValue",values:[{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}]}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"username"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hometown"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"HometownFields"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"myExternallyConnectedAccountTypes"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"loggedIn"}}}]}]},{kind:"Field",name:{kind:"Name",value:"insightProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uiCardsState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"states"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:533}};Ce.loc.source={body:"db3c37e81623"};var Se={};Ce.definitions=Ce.definitions.concat(function _e(e){return e.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!Se[n]&&(Se[n]=!0,!0)})}(ke.a.definitions));var we=Ce;t.d(n,"OnboardingController",function(){return Ie});var Fe=null,Ee=750,Ne=["MASTHEAD","DEFAULT","BRAND_EDUCATOR","FACEBOOK_ENGAGEMENT_CARD","UNKNOWN"],Ie=function(e){function n(e){var t;return a()(this,n),t=l()(this,c()(n).call(this,e)),b()(p()(p()(t)),"onFlowEnd",function(e){t.allowsPageRefresh()&&e?(_.a.set(N.OnboardingCompleteReload,!0),window.location.reload()):(t.setState({disabled:!0}),t.props.onboardingDone())}),b()(p()(p()(t)),"onClose",function(){t.setState({disabled:!0}),t.props.onboardingDone()}),b()(p()(p()(t)),"onDisable",function(){return t.setState({disabled:!0})}),b()(p()(p()(t)),"onScroll",function(){Fe+Ee<window.pageYOffset&&t.setState({waitForScroll:!1})}),b()(p()(p()(t)),"getFiredFrom",function(){return Object(A.isHomePageMemberGateTest)()&&t.isHome()&&"MOBILE"!==t.props.viewportCategory?Object(A.isHomePageMemberGateRegSplashTest)()?"REGISTRATION_SPLASH":"FULLSCREEN_SPLASH":"DEFAULT"}),b()(p()(p()(t)),"shouldOnboardingBeDisabled",function(){return Object(A.isHomePageMemberGateTest)()?t.userIsLoggedIn():!!Object(A.isOnboardingDisabledThroughFeature)(t.props.entryPoint,t.props.viewportCategory,t.props.servlet)||null!==t.props.cachedCookieFound&&t.props.cachedCookieFound}),b()(p()(p()(t)),"entryPointRequiresScrollToFire",function(){return A.ScrollEntrypoints.includes(t.props.entryPoint)}),b()(p()(p()(t)),"allowsPageRefresh",function(){return t.isHome()&&Ne.includes(t.state.firedFrom)}),b()(p()(p()(t)),"allowsLaunchOnPageLoad",function(){return t.isHome()}),b()(p()(p()(t)),"isHome",function(){return"Home"===t.props.servlet}),b()(p()(p()(t)),"userIsLoggedIn",function(){return null!==t.props.loggedInUserId}),t.state={disabled:t.shouldOnboardingBeDisabled(),waitForSignal:!0,waitForScroll:!1,firedFrom:t.getFiredFrom()},t.isHome()&&!t.userIsLoggedIn()&&Object(E.featureIsEnabled)("memx_control")&&C()({module:"homepage_softgate",action:"homepage_softgate_requested"}),t}return m()(n,e),r()(n,[{key:"componentDidMount",value:function e(){if(this.allowsLaunchOnPageLoad()){if(C()({module:me[this.state.firedFrom],action:"onboarding_onmount",context:this.userIsLoggedIn()?"logged_in":"logged_out"}),this.state.disabled)return void C()({module:me[this.state.firedFrom],action:"valuepropscreen_notshown",context:this.userIsLoggedIn()?"logged_in":"logged_out"});this.setState({waitForSignal:!1})}}},{key:"shouldComponentUpdate",value:function e(n){return null===this.props.cachedCookieFound&&n.cachedCookieFound&&this.setState({disabled:!0}),!0}},{key:"componentDidUpdate",value:function e(n){n.shouldFire||!this.props.shouldFire||Object(A.isOnboardingDisabledThroughFeature)(this.props.entryPoint,this.props.viewportCategory,this.props.servlet)||(this.setState({disabled:!1,waitForSignal:!1,waitForScroll:this.entryPointRequiresScrollToFire(),firedFrom:this.props.entryPoint}),this.entryPointRequiresScrollToFire()&&(Fe=window.pageYOffset))}},{key:"render",value:function e(){var n=this;return this.state.disabled||this.state.waitForSignal||this.props.readOnly||null===this.props.cachedCookieFound?null:this.state.waitForScroll?h.createElement(F.a,{callback:this.onScroll,throttle:600}):h.createElement(v.Query,{query:we,variables:{userId:this.props.loggedInUserId,loggedIn:this.userIsLoggedIn()},errorPolicy:"all"},function(e){var t=e.loading,o=e.data;return h.createElement(Oe,{firedFrom:n.state.firedFrom,onFlowEnd:n.onFlowEnd,onClose:n.onClose,onDisable:n.onDisable,immediateLoad:n.props.immediateLoad,loading:t,data:o})})}}]),n}(h.Component);n.default=Object(O.bind)({data:function e(n,t){var o=t("/data/1.0/onboarding/shown");return function(){var e=o.get().data;return{loggedInUserId:n.auth.loggedInUserId,viewportCategory:n.meta.device.viewportCategory,shouldFire:Object(I.getState)(n).shouldFire,immediateLoad:Object(I.getState)(n).immediateLoad,entryPoint:Object(I.getState)(n).entryPoint,cachedCookieFound:e?e.seen:null,readOnly:n.meta.readonlyMode,servlet:n.meta.initialServletName}}},actions:{onboardingDone:N.ACTIONS.onboardingDone}})(Ie)}}});
//# sourceMappingURL=social.onboarding-controller.fd9b2e31f8.js.map